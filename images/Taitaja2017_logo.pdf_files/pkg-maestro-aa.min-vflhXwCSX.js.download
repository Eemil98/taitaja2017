(function(){define("modules/clean/avatar/stacked_avatars",["external/react","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size","modules/clean/css","modules/core/user_i18n"],function(e,t,n,r,o,i){var s,a,l,c;return s=r.VALID_AVATAR_DIMENSIONS,l=e.DOM,c=e.PropTypes,a=e.createElement,e.createClass({displayName:"StackedAvatars",propTypes:{user_front:c.object.isRequired,user_back:c.object.isRequired,dimension:c.oneOf(s).isRequired,optionalClass:c.string,shape:c.oneOf(["CIRCLE","SQUARE"]).isRequired},getDefaultProps:function(){return{shape:"CIRCLE"}},componentDidMount:function(){return o.require_css("/static/css/scooter/scooter-scoped-vfl0UVTY2.css")},render:function(){var e,r;return e="stacked-avatar-bottom",r="stacked-avatar-top",this.props.optionalClass&&(e+=" "+this.props.optionalClass,r+=" "+this.props.optionalClass),l.div({className:"stacked-avatars-section u-l-ib"},a(t,{dimension:this.props.dimension,photoUrl:this.props.user_back.avatar_url,optionalClass:e,defaultAvatar:a(n,{dimension:this.props.dimension,name:this.props.user_back.display_name||this.props.user_back.email,initials:i.getInitials(this.props.user_back.display_name||this.props.user_back.email),shape:this.props.shape,optionalClass:e})}),a(t,{dimension:this.props.dimension,photoUrl:this.props.user_front.avatar_url,optionalClass:r,defaultAvatar:a(n,{dimension:this.props.dimension,name:this.props.user_front.display_name||this.props.user_front.email,initials:i.getInitials(this.props.user_front.display_name||this.props.user_front.email),shape:this.props.shape,optionalClass:r})}))}})})}).call(this),function(){define("modules/clean/browse_events",[],function(){return{RENDER:"db:browse:render",BEFORE_UPDATE:"db:browse:before_update",UPDATE:"db:browse:update",NEW_PAGE:"db:browse:new_page",UPDATE_RENDERED:"db:browse:update_rendered",GA_RENDERED:"db:browse:ga_rendered"}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function r(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},n={}.hasOwnProperty;define("modules/clean/contacts/facebook_modal",["modules/clean/dbmodal"],function(n){var r;return r=n.DBUserModal,(function(n){function r(t,n,o){this.show_hidden_modal=n,this.link_with_facebook=o,this.on_confirm_button_click=e(this.on_confirm_button_click,this),this.on_hide=e(this.on_hide,this),r.__super__.constructor.call(this,t,{element_id:"facebook-confirm-modal-user-"+t.id})}return t(r,n),r.prototype.on_hide=function(){return"function"==typeof this.show_hidden_modal?this.show_hidden_modal():void 0},r.prototype.on_confirm_button_click=function(e){return this.hide(),this.link_with_facebook()},r})(r)})}.call(this),function(){define("modules/clean/contacts/facebook_oauth",["jquery","modules/core/exception","modules/core/uri","modules/clean/ajax","modules/clean/viewer"],function(e,t,n,r,o){var i,assert;return assert=t.assert,i={do_auth:function(e,t){if(assert(null!=t,"user_id must be specified"),window.open(n({path:"/fb/access_token"}).updateQuery("_subject_uid",t).toString(),"fb_auth","width=600,height=450"),e)return i.onLoginSuccessCallback=e},post:function(e,t,s,a,l,c,u){return assert(null!=u,"user_id must be specified!"),o.get_viewer().is_signed_in?("function"==typeof i.custom_show_posting&&i.custom_show_posting(),new r.WebRequest({url:"/fb/post",data:{message:e,link:t,link_name:s,description:a,from_referrals:i.from_referrals,from_getspace:i.from_getspace,picture:l?l:""},success:function(n,r,o){var d;return d=o.responseText,0===d.indexOf("ok")?"function"==typeof i.custom_show_complete?i.custom_show_complete():void 0:0===d.indexOf("auth")?i.do_auth(function(){return i.post(e,t,s,a,l,c,u)},u):void 0},error:function(){return"function"==typeof c?c():void 0},subject_user:u})):void window.open(n.parse("http://www.facebook.com/sharer.php").setQuery({u:t,t:s}).toString())}}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/frame_messenger",[],function(){return(function(){function n(){this.handleUntrustedMessage=e(this.handleUntrustedMessage,this),Object.defineProperty(this,"trustedParentOriginForPosting",{get:function(){return this._trustedParentOriginForPosting}}),Object.defineProperty(this,"trustedChildOriginForPosting",{get:function(){var e,t,n,r,o;if(null!=this._trustedChildOriginForPosting)return this._trustedChildOriginForPosting;for(e=document.querySelectorAll(this._childIframeQuery),t=0,o=e.length;t<o&&(n=e[t],r=n.getAttribute("src"),!this._validateChildOriginForPosting(r));t++);return this._trustedChildOriginForPosting}})}return n._ALLOWED_CHILD_ORIGINS=["https://www.dropboxstatic.com","https://www.dropboxstatic.com:443","https://cf.dropboxstatic.com","https://cf.dropboxstatic.com:443","https://cfl.dropboxstatic.com","https://cfl.dropboxstatic.com:443","https://www.dropbox.com","https://www.dropbox.com:443","https://dl-doc.dropbox.com","https://dl-doc.dropbox.com:443","https://dl-web.dropbox.com","https://dl-web.dropbox.com:443","https://dl.dropboxusercontent.com","https://dl.dropboxusercontent.com:443","null"],n._ALLOWED_PARENT_ORIGINS=["https://www.dropbox.com","https://www.dropbox.com:443"],n._REQUEST_PARENT_ORIGIN_POLL_DELAY=100,n.prototype._childIframeQuery=null,n.prototype._trustedChildOriginForPosting=null,n.prototype._trustedParentOriginForPosting=null,n.prototype._validActionsFromChild=[],n.prototype._validActionsFromParent=[],n.prototype._trustedMessageFromChildHandler=null,n.prototype._trustedMessageFromParentHandler=null,n.prototype._parentMessageQueue=[],n.prototype._requestParentOriginPollRetry=null,n.prototype._onParentReady=null,n.prototype.resetOriginsForPosting=function(){return this._trustedChildOriginForPosting=null,this._trustedParentOriginForPosting=null},n.prototype.configureChildMessaging=function(e,t,n){return this._childIframeQuery=e,this._trustedChildOriginForPosting=null,this._validActionsFromChild=n,this._trustedMessageFromChildHandler=t},n.prototype.configureParentMessaging=function(e,t,n){return null==n&&(n=null),this._trustedParentOriginForPosting=null,this._validActionsFromParent=t,this._trustedMessageFromParentHandler=e,this._onParentReady=n},n.prototype.startListening=function(){if(window.addEventListener("message",this.handleUntrustedMessage),null!=this._validActionsFromParent&&this._validActionsFromParent.length>0&&null!=this._trustedMessageFromParentHandler&&this._requestParentOrigin(),null!=this._validActionsFromChild&&this._validActionsFromChild.length>0&&null!=this._trustedMessageFromChildHandler)return this.postMessageToChildren("parent-ready")},n.prototype.stopListening=function(){return window.removeEventListener("message",this.handleUntrustedMessage)},n.prototype._isNumber=function(e){return!isNaN(parseInt(e))},n.prototype._getOriginFromUrl=function(e){var t,n;return n=document.createElement("a"),n.href=e,t=this._isNumber(n.port)?":"+n.port:"","https://"+n.hostname+t},n.prototype._isChildOriginAllowed=function(e){return t.call(this.constructor._ALLOWED_CHILD_ORIGINS,e)>=0||this._isDevVmOrigin(e)},n.prototype._isParentOriginAllowed=function(e){return t.call(this.constructor._ALLOWED_PARENT_ORIGINS,e)>=0||this._isDevVmOrigin(e)},n.prototype._isDevVmOrigin=function(e){var t;return t=e.match(/\.dev\.corp\.dropbox(static|usercontent)?\.com($|:)/),(null!=t?t.length:void 0)>=1},n.prototype._validateChildOriginForPosting=function(e){var t;return t="null"===e?"*":this._getOriginFromUrl(e),"null"===e||this._isChildOriginAllowed(t)?(this._trustedChildOriginForPosting=t,!0):(console.warn("Untrusted message from child blocked: "+e),!1)},n.prototype.childIsValidated=function(){return null!=this._trustedChildOriginForPosting},n.prototype._validateParentOriginForPosting=function(e){var t,n,r,o,i,s,a;if(s=this._trustedParentOriginForPosting,i=this._getOriginFromUrl(e),!this._isParentOriginAllowed(i))return console.warn("Untrusted message from parent blocked: "+e),!1;if(this._trustedParentOriginForPosting=i,this._parentMessageQueue.length>0){for(a=this._parentMessageQueue,t=0,n=a.length;t<n;t++)r=a[t],o=JSON.parse(r),this.postMessageToParent(o.action,o.parameters);this._parentMessageQueue=[]}return null!=this._trustedParentOriginForPosting&&null==s&&null!=this._onParentReady&&this._onParentReady(),!0},n.prototype.handleUntrustedMessage=function(e){var n,r,o;if(!this._isChildOriginAllowed(e.origin)&&!this._isParentOriginAllowed(e.origin))return void console.warn("Message received not in parent or child origin whitelist: "+e.origin);try{n=JSON.parse(e.data)}catch(e){return void e}if(null!=n.action)return"child-requesting-parent-origin"===n.action?void(this._validateChildOriginForPosting(e.origin)&&this.postMessageToChildren("parent-ready")):"parent-ready"===n.action?void this._validateParentOriginForPosting(e.origin):(r=n.action,t.call(this._validActionsFromChild,r)>=0&&this._validateChildOriginForPosting(e.origin)&&null!=this._trustedMessageFromChildHandler?void this._trustedMessageFromChildHandler(n):(o=n.action,void(t.call(this._validActionsFromParent,o)>=0&&this._validateParentOriginForPosting(e.origin)&&null!=this._trustedMessageFromParentHandler&&this._trustedMessageFromParentHandler(n))))},n.prototype._packagePostMessage=function(e,t){var n;return this.trustedChildOriginForPosting,n={action:e,parameters:t},JSON.stringify(n)},n.prototype.postMessageToChildElements=function(e,t,n){var r,o,i,s,a;if(null==n&&(n={}),null!=this.trustedChildOriginForPosting){for(s=this._packagePostMessage(t,n),a=[],r=0,i=e.length;r<i;r++)o=e[r],a.push(o.contentWindow.postMessage(s,this.trustedChildOriginForPosting));return a}},n.prototype.postMessageToChildren=function(e,t,n){var r;return null==t&&(t={}),null==n&&(n=null),null==n&&(n=this._childIframeQuery),r=document.querySelectorAll(n),this.postMessageToChildElements(r,e,t)},n.prototype.postMessageToParent=function(e,t){var n;return null==t&&(t={}),n=this._packagePostMessage(e,t),null==this.trustedParentOriginForPosting?void this._parentMessageQueue.push(n):window.parent.postMessage(n,this.trustedParentOriginForPosting)},n.prototype._requestParentOrigin=function(){var e;return window.parent.postMessage('{"action": "child-requesting-parent-origin"}',"*"),e=function(){if(this._requestParentOriginPollRetry=null,null==this._trustedParentOriginForPosting)return this._requestParentOrigin()},setTimeout(e.bind(this),this._REQUEST_PARENT_ORIGIN_POLL_DELAY)},n})()})}.call(this),function(){define("modules/clean/groups/api",["jquery","modules/clean/ajax","modules/clean/contacts/cache_store","modules/clean/viewer"],function(e,t,n,r){var o,i,s;return o=n.DefaultContactsCacheStore,s={},i="/groups_ajax",s.ready=function(){},s.get_groups_for_user=function(e,t){return null==e&&(e={}),null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"get_groups_for_user",data:e,success:t})},s.get_group_info=function(e,t){return null==e&&(e={}),null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"get_group_info",data:e,success:t})},s.get_groups_for_team=function(e,t){return null==e&&(e={}),null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"get_groups_for_team",data:{},success:t})},s.get_users_for_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"get_users_in_group",data:e,success:t})},s.create_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"make_new_group",data:e,success:t,reload_contacts:!0})},s.create_group_with_users=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"make_new_group_with_users",data:e,success:t,reload_contacts:!0})},s.remove_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"remove_group",data:e,success:t,reload_contacts:!0})},s.rename_group=function(e,t,n){return null==n&&(n=function(){return{}}),s.metaserver_ajax({method:"rename_group",data:e,success:t,error:n,reload_contacts:!0})},s.add_users_to_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"add_users_to_group",data:e,success:t,reload_contacts:!0})},s.remove_user_from_group=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"remove_user_from_group",data:e,success:t,reload_contacts:!0})},s.change_group_member_type=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"change_group_member_type",data:e,success:t})},s.remove_namespace_from_group=function(e,t){return s.metaserver_ajax({method:"remove_namespace_from_group",data:e,success:t})},s.change_group_access_type=function(e,n){var o;return o=function(e,t,r){return n(r)},t.WebRequest({url:i+"/change_group_access_type",type:"post",data:e,subject_user:r.get_viewer().work_user,success:o})},s.make_group_join_request=function(e,t){return null==t&&(t=function(){return{}}),s.metaserver_ajax({method:"make_group_join_request",data:e,success:t})},s.metaserver_ajax=function(n){var s,a,l,c;return c=i+"/"+n.method,a=n.reload_contacts||!1,l=function(t){var r,i;i=JSON.parse(t),i.ok&&(n.success(i.data),e(".error_msg").hide()),a&&(r=o.getOrCreateForViewer(),r.load_contacts(!0))},s=function(t){var r;r=t.responseText,n.error&&(n.error(r.slice(4)),e(".error_msg").hide())},t.WebRequest({url:c,type:"post",data:n.data,subject_user:r.get_viewer().work_user,success:l,error:s})},s})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/legacy_pyxl_controllers/bubble_picker",["jquery","modules/clean/keycode"],function(t,n){var r;return r=n.KeyCode,(function(){function n(t){this.$bubble_picker=t,this._on_button_keydown=e(this._on_button_keydown,this),this._on_option_keydown=e(this._on_option_keydown,this),this._on_option_mouseenter=e(this._on_option_mouseenter,this),this.enable_option=e(this.enable_option,this),this.disable_option=e(this.disable_option,this),this.show_dropdown=e(this.show_dropdown,this),this.hide_dropdown=e(this.hide_dropdown,this),this.set_value=e(this.set_value,this),this._listen=e(this._listen,this),this.$label_wrapper=this.$bubble_picker.find(".bubble-picker-label-wrapper"),this.$label_wrapper.on("keydown",this._on_button_keydown),this.$label=this.$bubble_picker.find(".bubble-picker-label"),this.$dropdown=this.$bubble_picker.find(".bubble-picker-dropdown"),this.$options=this.$bubble_picker.find("*[role='option']"),this.$options.on("mouseenter",this._on_option_mouseenter),this.$options.on("keydown",this._on_option_keydown),this._dropdown_shown=!1,this._listen()}return n.CHANGED="db:bubblepicker:changed",n.prototype._listen=function(){return t(document).click((function(e){return function(n){var r,o;return o=t(n.target).closest(e.$label_wrapper).length>0,r=t(n.target).closest(e.$dropdown).length>0,e._dropdown_shown&&!r?e.hide_dropdown():o?e.show_dropdown():void 0}})(this)),this.$dropdown.find(".bubble-picker-option:not('.disabled')").click((function(e){return function(r){var o,i;if(r.preventDefault(),o=t(r.currentTarget),!o.hasClass("disabled"))return i=e.get_value(),e.set_value(o.data("value")),e.$bubble_picker.trigger(n.CHANGED,{clicked_val:o.data("value"),old_val:i}),e.hide_dropdown(),e.$label_wrapper.focus()}})(this))},n.prototype.get_value=function(){return this.$bubble_picker.attr("data-selected-value")},n.prototype.set_value=function(e){var t;return this.$bubble_picker.attr("data-selected-value",e),this.$label.empty(),this.$bubble_picker.find(".bubble-picker-option--selected").removeClass("bubble-picker-option--selected"),t=this.$bubble_picker.find("[data-value='"+e+"']").addClass("bubble-picker-option--selected"),this.$label.html(t.clone().html())},n.prototype.hide_dropdown=function(){return this.$dropdown.hide(),this.$label_wrapper.attr("aria-expanded",!1),this._dropdown_shown=!1},n.prototype.show_dropdown=function(){var e,n;return this.$dropdown.show(),this.$label_wrapper.attr("aria-expanded",!0),this._dropdown_shown=!0,this.$options.attr({tabindex:-1,"aria-selected":!1}),n=this.$bubble_picker.attr("data-selected-value"),e=n?this.$bubble_picker.find(".bubble-picker-option[data-value='"+n+"']")[0]:this.$bubble_picker.find(".bubble-picker-option")[0],t(e).attr({tabindex:0,"aria-selected":!0}).focus()},n.prototype.disable_option=function(e,n){var r,o;return o=this.$bubble_picker.find(".bubble-picker-option[data-value="+e+"]:not('.disabled')"),o.length>0&&(r=t(o.find(".role-option")),r.attr("saved-title",r.attr("title")),r.attr("title",n),r.attr("aria-disabled",!0)),o.addClass("disabled")},n.prototype.enable_option=function(e){var n,r;return r=this.$bubble_picker.find(".bubble-picker-option.disabled[data-value="+e+"]"),n=t(r.find(".role-option")),n.attr("saved-title")&&(n.attr("title",n.attr("saved-title")),n.removeAttr("saved-title")),n.attr("aria-disabled",!1),r.removeClass("disabled")},n.prototype._change_focus=function(e,n){return t(e).attr({tabindex:-1,"aria-selected":!1}),t(n).attr({tabindex:0,"aria-selected":!0}).focus()},n.prototype._focus_previous=function(e){var t;if(t=this.$options.index(e),t>0)return this._change_focus(e,this.$options.get(t-1))},n.prototype._focus_next=function(e){var t;if(t=this.$options.index(e),t<this.$options.length-1)return this._change_focus(e,this.$options.get(t+1))},n.prototype._on_option_mouseenter=function(e){return this.$dropdown.removeClass("bubble-picker-dropdown--keyboard")},n.prototype._on_option_keydown=function(e){this.$dropdown.addClass("bubble-picker-dropdown--keyboard"),e.keyCode===r.ESC?(this.hide_dropdown(),this.$label_wrapper.focus()):e.keyCode===r.DOWN?(this._focus_next(e.target),e.preventDefault()):e.keyCode===r.UP?(this._focus_previous(e.target),e.preventDefault()):e.keyCode!==r.TAB||e.shiftKey||this.hide_dropdown()},n.prototype._on_button_keydown=function(e){e.keyCode===r.ENTER?this.$dropdown.addClass("bubble-picker-dropdown--keyboard"):e.keyCode===r.TAB&&e.shiftKey&&this.hide_dropdown()},n})()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},n=function(e,t){function n(){this.constructor=e}for(var o in t)r.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},r={}.hasOwnProperty;define("modules/clean/legacy_pyxl_controllers/role_picker",["external/underscore","modules/core/controller_helpers","modules/core/exception","modules/clean/multiaccount_login","modules/clean/page_role_observer","modules/clean/viewer"],function(r,o,i,s,a,l){var c,u,d,p,assert;return assert=i.assert,d={ALL:"all",PERSONAL:"personal",WORK:"work"},u=(function(){function n(n){var o,i,s,a,c,u;null==n&&(n={}),this._actually_set_state=e(this._actually_set_state,this),this._do_login=e(this._do_login,this),this.is_user_visible=e(this.is_user_visible,this),this.is_role_visible=e(this.is_role_visible,this),this.ensure_role_is_visible=e(this.ensure_role_is_visible,this),this.set_state=e(this.set_state,this),this.get_state=e(this.get_state,this),this._allow_merged_state=null==n.allow_merged_state||n.allow_merged_state,this._limit_to_role=null!=n.limit_to_role?n.limit_to_role:null,u=l.get_viewer(),i=u.is_role_signed_in(d.PERSONAL)&&u.is_role_signed_in(d.WORK),n.initial_state?(a=r.values(d),assert((s=n.initial_state,t.call(a,s)>=0),"RolePicker requires initial_state to be one of: "+a),this.set_state(n.initial_state)):this._allow_merged_state&&i?this.set_state(d.ALL):(o=u.get_users(),assert(o.length,"tried to use RolePicker on a page with no users"),c=o[0],this.set_state(c.role))}return n.prototype.get_state=function(){return this._state},n.prototype.set_state=function(e){var t,n,r,o;if(assert(this._allow_merged_state||e!==d.ALL,"tried to set merged state in non-merged picker"),null!=this._limit_to_role&&assert(e===d.ALL||e===this._limit_to_role),e===d.ALL){for(r=["personal","work","photos"],t=0,n=r.length;t<n;t++)if(o=r[t],!l.get_viewer().is_role_signed_in(o))return void this._do_login(o,e)}else if(o=e,!l.get_viewer().is_role_signed_in(o))return void this._do_login(o,e);return this._actually_set_state(e)},n.prototype.update_picker_ui=function(){},n.prototype.ensure_role_is_visible=function(e){if(!this.is_role_visible(e))return this._allow_merged_state?this.set_state(d.ALL):this.set_state(e)},n.prototype.is_role_visible=function(e){return this._state===d.ALL||this._state===e},n.prototype.is_user_visible=function(e){return this.is_role_visible(e.role)},n.prototype._do_login=function(e,t){return s.show_modal({role:e,on_success:(function(e){return function(){return e._actually_set_state(t)}})(this)})},n.prototype._actually_set_state=function(e){if(e!==this._state)return this._state=e,this.update_picker_ui(),"function"==typeof this.on_state_change?this.on_state_change(e):void 0},n})(),p=(function(t){function r(t,n){this.$container=t,null==n&&(n={}),this.limit_to_role=e(this.limit_to_role,this),this.update_picker_ui=e(this.update_picker_ui,this),this.on_ui_change=e(this.on_ui_change,this),this.$bubble_picker=this.$container.find(".bubble-picker"),this.$bubble_picker.on("db:bubblepicker:changed",this.on_ui_change),r.__super__.constructor.call(this,n)}return n(r,t),r.prototype.on_ui_change=function(e,t){var n;if(n=t.clicked_val,n!==this._state)return o.get_controller(this.$bubble_picker).set_value(this._state),this.set_state(n)},r.prototype.update_picker_ui=function(){return o.get_controller(this.$bubble_picker).set_value(this._state)},r.prototype.limit_to_role=function(e,t){var n,r;if(null!=e){this.ensure_role_is_visible(e);for(n in d)r=d[n],r!==e&&r!==d.ALL&&o.get_controller(this.$bubble_picker).disable_option(r,t)}else for(n in d)r=d[n],o.get_controller(this.$bubble_picker).enable_option(r);return this._limit_to_role=e},r})(u),c=(function(e){function t(e,n){null==n&&(n={}),n.allow_merged_state=!1,t.__super__.constructor.call(this,e,n)}return n(t,e),t.prototype.on_state_change=function(e){var t;return t=(function(){switch(e){case d.PERSONAL:return"personal";case d.WORK:return"work"}})(),a.emit(t)},t})(p),{RolePickerState:d,RolePicker:u,RoleSelect:p,PageRoleSelect:c}})}.call(this),define("modules/clean/payments/cash",["require","exports","modules/core/i18n"],function(e,t,n){"use strict";var r=(function(){function e(){}return e.set_locale_number_format=function(t,n,r){void 0===t&&(t=","),void 0===n&&(n="."),void 0===r&&(r="-"),e.groupSymbol=t,e.decimalSymbol=n,e.minusSignSymbol=r},e.set_currency_format_map=function(t){e.currencyFormatMap=t},e.update_currency_format_map=function(t,n){e.currencyFormatMap[t]=n},e.formatAmountThousandsHelper=function(t){var n=Math.abs(parseInt(t,10)).toFixed(0).toString();if(n.length<=3)return n;var r=n.substr(0,n.length-3);return e.formatAmountThousandsHelper(r)+e.groupSymbol+n.substr(n.length-3)},e.roundCurrency=function(t,n,r){return void 0===n&&(n="USD"),void 0===r&&(r=2),r=t%1===0?0:r,e.formatCurrency(t,n,r)},e.formatCurrency=function(t,n,r){void 0===n&&(n="USD"),void 0===r&&(r=2);var o=parseFloat(t);"JPY"===n&&(r=0);var i=e.formatNumber(o,r);return e.currencyFormatMap[n]?e.currencyFormatMap[n].replace("%v",i):i+" "+n},e.splitFormatCurrency=function(t,n,r){void 0===n&&(n="USD"),void 0===r&&(r=2);var o=e.formatCurrency(t,n,r),i=o.indexOf(e.decimalSymbol);return i===-1?[o,""]:[o.slice(0,i+1),o.slice(i+1)]},e.formatNumber=function(t,n){void 0===n&&(n=2);var r=t<0?e.minusSignSymbol:"",o="";return n>0&&(o=e.decimalSymbol+t.toFixed(n).split(".")[1]),r+e.formatAmountThousandsHelper(t)+o},e.removeFormatting=function(t,n){var r=e.currencyFormatMap[n],o=r.replace("%v","");return t.replace(o,"").replace(e.groupSymbol,"")},e})();r.groupSymbol=",",r.decimalSymbol=".",r.minusSignSymbol="-",r.currencyFormatMap={USD:"$%v"},t.CashUtil=r;var o=(function(){function e(e,t){this.cash1=e,this.cash2=t}return e})();t.CashCurrenciesDoNotMatch=o;var i=(function(){function e(){}return e})();t.CashNeedsAmountAndCurrency=i;var s=(function(){function e(e,t){if(this.currency=t,this.amount=parseFloat(e),isNaN(this.amount)||!this.currency)throw new i}return e.fromObject=function(t){return new e(parseFloat(t.amount),t.currency)},e.fromString=function(t,n){return new e(r.removeFormatting(t,n),n)},e.prototype.add=function(t){if(this.currency!==t.currency)throw new o(this,t);return new e(this.amount+t.amount,this.currency)},e.prototype.subtract=function(t){return this.add(new e(-t.amount,t.currency))},e.prototype.multiply=function(t){return new e(this.amount*t,this.currency)},e.prototype.divide=function(t){return new e(this.amount/t,this.currency)},e.prototype.round=function(t){void 0===t&&(t=2);var n=Math.pow(10,t);return new e(Math.round(this.amount*n)/n,this.currency)},e.prototype.toString=function(e){return void 0===e&&(e=2),"JPY"===this.currency&&(e=0),r.roundCurrency(this.amount,this.currency,e)},e.prototype.formatCurrency=function(e){return void 0===e&&(e=2),r.formatCurrency(this.amount,this.currency,e)},e.formatWithTaxLabels=function(e,t){return t.doesTaxApply?n._("%(price)s, including applicable taxes").format({price:e.formatCurrency()}):e.formatCurrency()},e})();t.Cash=s}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/payments/dfb_util",["external/underscore","modules/clean/ajax","modules/clean/payments/cash","modules/clean/payments/validation","modules/core/exception"],function(t,n,r,o,i){var s,a,l,c,assert;return s=r.Cash,assert=i.assert,c=(function(){function e(e,t,n,r,o,i,s){this.plan_ids=e,this.schedule_ids=t,this.license_ids_and_counts=n,this.currencies=r,this.country_code=o,this.zip_code=i,this.vat_id=s,this.renew=!1,this.discount_ratio=0,this.discount_allow_monthly=!1}return e.prototype.set_only_license_count=function(e){var t;return t=Object.keys(this.license_ids_and_counts)[0],this.license_ids_and_counts[t]=e},e.prototype.get_only_license_count=function(){var e;return e=Object.keys(this.license_ids_and_counts)[0],this.license_ids_and_counts[e]},e.prototype.set_country_code=function(e){this.country_code=e},e.prototype.set_zip_code=function(e){this.zip_code=e},e.prototype.set_currencies=function(e){this.currencies=e},e.prototype.set_renew=function(e){this.renew=e},e.prototype.set_discount_ratio=function(e){this.discount_ratio=e},e.prototype.set_discount_allow_monthly=function(e){this.discount_allow_monthly=e},e.prototype.set_vat_id=function(e){return""!==e&&o.validateVat(this.country_code,e)?this.vat_id=e:this.vat_id=""},e.prototype.cache_key=function(e){var t;return null==e&&(e=!1),this.currencies&&!e&&(t=this.currencies.join(",")),[this.plan_ids.join(","),this.schedule_ids.join(","),this.get_only_license_count(),t,this.country_code,this.zip_code,this.vat_id,this.renew,this.discount_ratio].join(":")},e.prototype.to_json=function(){var e;return e=this.renew?{renew:1}:{},e=t.extend(e,{plan_ids:JSON.stringify(this.plan_ids),schedule_ids:JSON.stringify(this.schedule_ids),license_ids_and_counts:JSON.stringify(this.license_ids_and_counts),currencies:this.currencies?JSON.stringify(this.currencies):"",country_code:this.country_code,zip_code:this.zip_code,vat_id:this.vat_id,discount_percentage:JSON.stringify(100*this.discount_ratio),discount_allow_monthly:this.discount_allow_monthly})},e.from_transition_view_models=function(n){var r,o,i,s,a,l,c,u,d,p,h,_,m,f,g,y,v,b,w,k,S,x,E,C;for(h=[],S=[],i=[],p=!1,o=!1,E=!1,C=!1,s=0,c=n.length;s<c;s++)if(x=n[s],h.push(x.state.plan.id),S.push(x.state.schedule.id),i.push(x.state.currency),p===!1){for(p={},_=x.state.allocated_licenses,a=0,u=_.length;a<u;a++)r=_[a],p[r.license_id]=r.license_count;o=null!=(m=x.read_only_invoice)?m.tax_country_code:void 0,E=null!=(f=null!=(g=x.read_only_invoice)?g.tax_exclusion_id:void 0)?f:null,C=null!=(y=x.read_only_invoice)?y.tax_zip_code:void 0}else{for(assert(x.state.allocated_licenses.length===Object.keys(p).length,"License sets differ"),v=x.state.allocated_licenses,l=0,d=v.length;l<d;l++)r=v[l],assert(r.license_id in p,"License sets differ"),assert(p[r.license_id]===r.license_count,"License count must match");assert(o===(null!=(b=x.read_only_invoice)?b.tax_country_code:void 0),"country codes must match"),assert(C===(null!=(w=x.read_only_invoice)?w.tax_zip_code:void 0),"zip codes must match"),assert(E===(null!=(k=x.read_only_invoice)?k.tax_exclusion_id:void 0),"VAT IDs must match")}return new e(t.uniq(h),t.uniq(S),p,t.uniq(i),o,C,E)},e})(),a=(function(){function e(e){var t,n;this.transition_view_model=e,this.transition_view_model.read_only_invoice?this.current_total=s.fromObject(this.transition_view_model.read_only_invoice.total):this.current_total=new s(0,this.transition_view_model.state.currency),this.price_token=this.transition_view_model.expected_price,this.transition_view_model.state.per_license_prices.length?this.per_license_price=s.fromObject(this.transition_view_model.state.per_license_prices[0].price):this.per_license_price=new s(0,this.transition_view_model.state.currency),this.recurring_total=s.fromObject(this.transition_view_model.state.total_recurring_price),this.transition_view_model.prices?this.tax=s.fromObject(this.transition_view_model.prices.tax):this.tax=new s(0,this.recurring_total.currency),this.transition_view_model.total_recurring_taxes?this.recurring_tax=s.fromObject(this.transition_view_model.total_recurring_taxes):this.recurring_tax=new s(0,this.recurring_total.currency),this.recurring_total_tax=this.recurring_total.add(this.recurring_tax),this.tax_percentage=0,this.transition_view_model.read_only_invoice&&(n=this.transition_view_model.read_only_invoice.line_items,t=n.length>0?n[0]:void 0,(null!=t?t.country_tax_percentage:void 0)?this.tax_percentage=t.country_tax_percentage:(null!=t?t.state_tax_percentage:void 0)&&(this.tax_percentage=t.state_tax_percentage))}return e})(),l=(function(){function t(t){this.default_transition_view_models=t,this._get_transition_info_for=e(this._get_transition_info_for,this),this._add_to_cache=e(this._add_to_cache,this),this.has_inflight_request=e(this.has_inflight_request,this),this.transition_view_model_requests={},this.transition_info_cache={},this._add_to_cache(this.default_transition_view_models)}return t.prototype.get=function(e,t,r){var o,i,s;return s=c.from_transition_view_models(this.default_transition_view_models),t.total_users&&s.set_only_license_count(t.total_users),t.country_code&&s.set_country_code(t.country_code),t.currency&&s.set_currencies([t.currency]),t.remove_currency&&s.set_currencies(),t.zip_code&&s.set_zip_code(t.zip_code),t.renew&&s.set_renew(t.renew),(t.vat_id||""===t.vat_id)&&s.set_vat_id(t.vat_id),t.discount_ratio&&s.set_discount_ratio(t.discount_ratio),null!=t.discount_allow_monthly&&s.set_discount_allow_monthly(t.discount_allow_monthly),o=s.cache_key(),(i=this._get_transition_info_for(o))?void e(i):this.transition_view_model_requests[o]?void 0:(this.transition_view_model_requests[o]=!0,n.SilentBackgroundRequest({url:"/business/transition-model",type:"GET",dataType:"json",data:s.to_json(),success:(function(n){return function(r){var i;return delete n.transition_view_model_requests[o],i=n._add_to_cache(r,t.remove_currency),e(i)}})(this),error:(function(e){return function(t){return"function"==typeof r&&r(t),delete e.transition_view_model_requests[o]}})(this)}))},t.prototype.has_inflight_request=function(){return Object.keys(this.transition_view_model_requests).length},t.prototype._add_to_cache=function(e,t){var n,r,o;return null==t&&(t=!1),n=c.from_transition_view_models(e).cache_key(t),r=(function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)o=e[t],r.push(new a(o));return r})(),this.transition_info_cache[n]=r,r},t.prototype._get_transition_info_for=function(e){return e in this.transition_info_cache?this.transition_info_cache[e]:null},t})(),{DfBTransitionInfo:a,DfBTransitionInfoFetcher:l}})}.call(this),define("modules/clean/payments/validation",["require","exports"],function(e,t){
"use strict";function n(e,t){return!t.trim().length||!!s[e]&&s[e].regex.test(t)}function r(e){return s[e]?s[e].prefix:""}function o(e){return s[e]?s[e].examples:[]}function i(e){if(e=e.replace(/\s+/g,""),e.length<2)return!1;switch(e.substring(0,2)){case"AT":return/^AT[0-9]{18}$/.test(e);case"BE":return/^BE[0-9]{14}$/.test(e);case"CY":return/^CY[0-9]{10}[0-9a-zA-Z]{16}$/.test(e);case"CZ":return/^CZ[0-9]{22}$/.test(e);case"DE":return/^DE[0-9]{20}$/.test(e);case"EE":return/^EE[0-9]{18}$/.test(e);case"ES":return/^ES[0-9]{22}$/.test(e);case"FI":return/^FI[0-9]{16}$/.test(e);case"FR":return/^FR[0-9]{12}[0-9a-zA-Z]{11}[0-9]{2}$/.test(e);case"GR":return/^GR[0-9]{9}[0-9a-zA-Z]{16}$/.test(e);case"HU":return/^HU[0-9]{26}$/.test(e);case"HR":return/^HR[0-9]{19}$/.test(e);case"IE":return/^IE[0-9]{2}[0-9a-zA-Z]{4}[0-9]{14}$/.test(e);case"IT":return/^IT[0-9]{2}[A-Z]{1}[0-9]{10}[0-9a-zA-Z]{12}$/.test(e);case"LU":return/^LU[0-9]{5}[0-9a-zA-Z]{13}$/.test(e);case"NL":return/^NL[0-9]{2}[A-Z]{4}[0-9]{10}$/.test(e);case"PL":return/^PL[0-9]{26}$/.test(e);case"PT":return/^PT[0-9]{23}$/.test(e);case"SE":return/^SE[0-9]{22}$/.test(e)}return!1}var s={AT:{prefix:"AT",regex:/^ATU[0-9]{8}$/,examples:["ATU12345678"]},BE:{prefix:"BE",regex:/^BE(0?|1)[0-9]{9}$/,examples:["BE0123456789","BE1123456789","BE1234567890"]},BG:{prefix:"BG",regex:/^BG[0-9]{9,10}$/,examples:["BG123456789","BG1234567890"]},CH:{prefix:"CH",regex:/^CHE[0-9]{9}(TVA|MWST|IVA)$/,examples:["CHE123456789TVA","CHE123456789MWST","CHE123456789IVA"]},CY:{prefix:"CY",regex:/^CY[0-9]{8}[A-Z]$/,examples:["CY12345678X"]},CZ:{prefix:"CZ",regex:/^CZ[0-9]{8,10}$/,examples:["CZ12345678","CZ123456789","CZ1234567890"]},DE:{prefix:"DE",regex:/^DE[0-9]{9}$/,examples:["DE123456789"]},DK:{prefix:"DK",regex:/^DK[0-9]{8}$/,examples:["DK12345678"]},EE:{prefix:"EE",regex:/^EE[0-9]{9}$/,examples:["EE123456789"]},GR:{prefix:"EL",regex:/^EL[0-9]{9}$/,examples:["EL123456789"]},ES:{prefix:"ES",regex:/^ES([A-Z][0-9]{7}[0-9A-Z]|[0-9A-Z][0-9]{7}[A-Z])$/,examples:["ESX12345678","ES12345678X","ESX1234567X"]},FI:{prefix:"FI",regex:/^FI[0-9]{8}$/,examples:["FI12345678"]},FR:{prefix:"FR",regex:/^FR[0-9A-Z]{2}[0-9]{9}$/,examples:["FR12345678901","FRX1234567890","FR1X123456789","FRXX123456789"]},GB:{prefix:"GB",regex:/^GB([0-9]{9}|[0-9]{12}|GD[0-9]{3}|HA[0-9]{3})$/,examples:["GB123456789","GB123456789012","GBGD123","GBHA123"]},HR:{prefix:"HR",regex:/^HR[0-9]{11}$/,examples:["HR12345678901"]},HU:{prefix:"HU",regex:/^HU[0-9]{8}$/,examples:["HU12345678"]},IE:{prefix:"IE",regex:/^IE([0-9][0-9A-Z+*][0-9]{5}[A-Z]{1,2}|[0-9]{7}WI)$/,examples:["IE1X23456X","IE1X23456X","IE1234567XX"]},IT:{prefix:"IT",regex:/^IT[0-9]{11}$/,examples:["IT12345678901"]},LT:{prefix:"LT",regex:/^LT([0-9]{9}|[0-9]{12})$/,examples:["LT123456789","LT123456789012"]},LU:{prefix:"LU",regex:/^LU[0-9]{8}$/,examples:["LU12345678"]},LV:{prefix:"LV",regex:/^LV[0-9]{11}$/,examples:["LV12345678901"]},MT:{prefix:"MT",regex:/^MT[0-9]{8}$/,examples:["MT12345678"]},NL:{prefix:"NL",regex:/^NL[0-9]{9}B[0-9]{2}$/,examples:["NL123456789B01"]},NO:{prefix:"NO",regex:/^NO[0-9]{9}(MVA)?$/,examples:["NO123456789","NO123456789MVA"]},PL:{prefix:"PL",regex:/^PL[0-9]{10}$/,examples:["PL1234567890"]},PT:{prefix:"PT",regex:/^PT[0-9]{9}$/,examples:["PT123456789"]},RO:{prefix:"RO",regex:/^RO[0-9]{2,10}$/,examples:["RO12","RO1234567890"]},SE:{prefix:"SE",regex:/^SE[0-9]{12}$/,examples:["SE123456789012"]},SI:{prefix:"SI",regex:/^SI[0-9]{8}$/,examples:["SI12345678"]},SK:{prefix:"SK",regex:/^SK[0-9]{10}$/,examples:["SK1234567890"]}};t.validateVat=n,t.getVatPrefix=r,t.getVatExamples=o,t.validIBANForCountry=i}),function(){define("modules/clean/photos/thumb_loading/batching_thumb_loader",["modules/clean/photos/batch_thumb_loader","modules/clean/photos/thumb_loading/utils"],function(e,t){var n;return n=t.load_individual_image,(function(){function t(){this.batch_thumb_loader=new e({})}return t.prototype.get_request_id=function(){return this.batch_thumb_loader.vend_request_id()},t.prototype.load_image=function(e,t,n,r,o,i){return this.batch_thumb_loader.queue_thumb(e,this._thumb_loaded.bind(this,{url:e,request_id:t,success:r,error:o,should_retry:i}),{onrequest:n,request_id:t}),window.setTimeout(this.batch_thumb_loader.flush.bind(this.batch_thumb_loader,10))},t.prototype._thumb_loaded=function(e,t){var r,o,i,s;return s=e.url,e.request_id,i=e.success,r=e.error,o=e.should_retry,0===t.indexOf("data:")?i(t):n(s,0,i,r,o)},t.prototype.cancel_thumb=function(e){return this.batch_thumb_loader.cancel_thumb(e)},t})()})}.call(this),function(){define("modules/clean/photos/thumb_store",["modules/constants/request","modules/clean/photos/thumb_loading/batching_thumb_loader","modules/clean/photos/thumb_loading/generic_thumb_store"],function(e,t,n){return function(r){var o,i,s,a;return o=null!=(i=(null!=r?r:{}).allow_http2)&&i,s=void 0,a=e.IS_HTTP2&&o,a||(s=new t),new n(s,!a)}})}.call(this),define("modules/clean/react/file_sidebar/comments_wrapper_component",["require","exports","tslib","external/react","modules/clean/activity/constants","modules/clean/comments/action_creators","modules/clean/comments/demo_action_creators","modules/clean/comments/store","modules/clean/react/css"],function(e,t,n,r,o,i,s,a,l){"use strict";var c=(function(t){function l(n){var r=t.call(this,n)||this;return r.state={commentsLoaded:e.defined("modules/clean/comments/components/file_comments_pane_container")},r}return n.__extends(l,t),l.prototype.componentDidMount=function(){var t=this,n=this.state.commentsLoaded,r=this.props,o=r.hidePageChrome,i=r.isCommentsDemo;n||o&&!i||e(["modules/clean/comments/components/file_comments_pane_container"],function(){t.setState({commentsLoaded:!0})})},l.prototype.render=function(){var t=this.state.commentsLoaded,n=this.props,l=n.activityContext,c=n.currentFile,u=n.hideComments,d=n.hidePageChrome,p=n.isCommentsDemo,h=n.sharedLinkInfo,_=n.shouldInitiallyFocusInput,m=n.user,f=n.showToggleButton;if(u||d&&!p)return null;if(!t)return c.feedback_off||a.areCommentsHidden()?r.createElement("div",null):r.createElement("div",{id:"file-comments",className:"file-feedback"},r.createElement("div",{className:"comment-holder"}));var g=e("modules/clean/comments/components/file_comments_pane_container"),y=p?s:i,v=p?-1:m?m.id:void 0,b=null;switch(l){case o.ActivityContext.BROWSE_FILE_VIEWER:b=c.fq_path;break;case o.ActivityContext.SHARED_CONTENT_LINK_VIEW:case o.ActivityContext.SHARED_LINK_VIEW:h&&(b=h.url)}return r.createElement("div",{className:"react-file-viewer__activity"},r.createElement(g,{actionCreators:y,actorId:v,context:l,contextData:b,currentFile:c,isDemoMode:p,previewSelector:".react-file-viewer__preview .flex-preview-container",shouldInitiallyFocusInput:_,showToggleButton:f}))},l})(r.Component),u=["/static/css/comments-vflsXFwoy.css","/static/css/comments_annotations-vflc_CKz1.css","/static/css/file_comments_pane-vflOi80Om.css"];t.CommentsWrapperComponent=l(c,u)}),define("modules/clean/react/file_sidebar/file_sidebar",["require","exports","tslib","external/react","modules/constants/file_viewer","modules/clean/react/file_sidebar/comments_wrapper_component","modules/clean/react_logger"],function(e,t,n,r,o,i,s){"use strict";var a=(function(t){function s(n){var r=t.call(this,"FileSidebar",n)||this;return r._isMounted=!1,r.state={fileSidebarLoaded:e.defined("modules/clean/react/file_sidebar/file_sidebar_component")},r}return n.__extends(s,t),s.prototype.componentDidMount=function(){var n=this;this._isMounted=!0,o.FILE_ACTIVITY_STREAM&&o.MAESTRO_ENABLED&&(this.state.fileSidebarLoaded||e(["modules/clean/react/file_sidebar/file_sidebar_component"],function(){n._isMounted&&n.setState({fileSidebarLoaded:!0})})),t.prototype.componentDidMount.call(this)},s.prototype.componentWillUnmount=function(){this._isMounted=!1},s.prototype.render=function(){if(o.FILE_ACTIVITY_STREAM&&o.MAESTRO_ENABLED){if(this.state.fileSidebarLoaded){var t=e("modules/clean/react/file_sidebar/file_sidebar_component").FileSidebarComponent;return r.createElement(t,n.__assign({},this.props))}return null}return r.createElement(i.CommentsWrapperComponent,n.__assign({},this.props,{showToggleButton:o.MAESTRO_ENABLED}))},s})(s.ReactLogger);t.FileSidebar=a}),define("modules/clean/react/file_viewer/container",["require","exports","tslib","external/react","modules/clean/react/browse/models","modules/clean/react/file_viewer/actions","modules/clean/react/file_viewer/file_viewer","modules/clean/react/open_in_app/actions","modules/clean/react/pass/utils","modules/clean/react_logger","modules/clean/sharing/async_share_modal_util"],function(e,t,n,r,o,i,s,a,l,c,u){"use strict";var d=(function(e){function t(t){var n=e.call(this,"FileViewerContainer",t)||this;return n.onCloseViewer=function(){return window.open(n.props.onCloseUrl,"_self")},n}return n.__extends(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this);var t=this.props.sharedLinkInfo?[this.props.sharedLinkInfo]:[],n=this.props.shareToken?[this.props.shareToken]:[],r=this.props.sharePermissions?[this.props.sharePermissions]:[],o={sharedLinkInfos:t,shareTokens:n,sharePermissions:r,disableFlipping:!1};if(i.setup(this.props.files,this.props.currentIndex,this.props.user,o),this.props.passOnboardingInfo&&l.PassOnboardingHelpers.setOnboardingInfo(this.props.passOnboardingInfo),this.props.openImmediatelyInApp){var s=this.props.files[this.props.currentIndex];a.openImmediately(s.open_in_app_data)}},t.prototype.componentWillUnmount=function(){i.cleanup()},t.prototype.componentDidMount=function(){var t=this.props.shareEmail;t&&u.asyncShowPrefilledShareModal({user:this.props.user,sharePrefillEmail:t,content:new o.File(this.props.files[this.props.currentIndex])}),e.prototype.componentDidMount.call(this)},t.prototype.render=function(){var e=this.props,t=e.fileViewerProps;return null!=e.onCloseUrl&&(t.onCloseViewer=this.onCloseViewer),r.createElement(s.FileViewer,n.__assign({},t))},t})(c.ReactLogger);t.FileViewerContainer=d}),function(){define("modules/clean/react/icon",["external/classnames","external/react","external/underscore","modules/clean/filepath","modules/clean/react/sprite"],function(e,t,n,r,o){var i,s,a,l,c,u,d;return u=r.file_icon,d=r.folder_icon,a=r.ICON_SIZES,c=t.createElement,l=t.createClass({displayName:"IconSprite",propTypes:{alt:t.PropTypes.string,className:t.PropTypes.string,name:t.PropTypes.string.isRequired},getDefaultProps:function(){return{alt:"",className:""}},render:function(){return c(o,{alt:this.props.alt,className:e(["icon",this.props.className]),group:"web",name:this.props.name})}}),i=t.createClass({displayName:"FileIcon",propTypes:{alt:t.PropTypes.string,className:t.PropTypes.string,file:t.PropTypes.shape({filename:t.PropTypes.string.isRequired}).isRequired,size:t.PropTypes.oneOf(n.values(a))},getDefaultProps:function(){return{className:"",size:a.LARGE}},render:function(){return c(l,{alt:this.props.alt,className:this.props.className,name:u(this.props.file.filename,{size:this.props.size})})}}),s=t.createClass({displayName:"FolderIcon",propTypes:{alt:t.PropTypes.string,className:t.PropTypes.string,size:t.PropTypes.oneOf(n.values(a))},getDefaultProps:function(){return{className:"",size:a.LARGE}},render:function(){return c(l,{alt:this.props.alt,className:this.props.className,name:d({size:this.props.size})})}}),{FileIcon:i,FolderIcon:s,ICON_SIZES:a}})}.call(this),define("modules/clean/react/share_sync/actions",["require","exports","modules/clean/multiaccount_login","modules/clean/sharing/shared_content_link_sync_utils","modules/clean/viewer"],function(e,t,n,r,o){"use strict";function i(e,t,i){new Promise(function(e,r){o.get_viewer().is_role_signed_in(t)?e():n.show_modal({role:t,on_success:function(){e()}})}).then(function(){r.mountSharedFolder(e,t,i)})}t.syncToDropbox=i}),define("modules/clean/react/share_sync/button",["require","exports","tslib","external/react","modules/clean/react/bubble_menu","modules/clean/react/share_sync/models","modules/clean/sharing/constants","modules/clean/sharing/views/sync_coachmark","modules/clean/react/sprite_div","modules/clean/viewer","modules/core/i18n"],function(e,t,n,r,o,i,s,a,l,c,u){"use strict";var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.options.map(function(e){return r.createElement(o.BubbleMenuItem,{onClick:function(){return e.handler()},disabled:e.isDisabled},r.createElement(l,{group:"web",name:e.spriteName,text:e.text}))});return r.createElement(o.BubbleMenu,{targetButton:this.props.targetButton,position:o.BubbleMenu.POSITIONS.BOTTOM,verticalDisplacement:4,items:e})},t})(r.Component),p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.onClickedOption=function(e,t){e.preventDefault(),t.handler()},t.prototype.getSyncOptions=function(){var e=this,t=this.props.sharePermission.canSyncToDropboxRoles,n=c.get_viewer();return t.map(function(t){return i.ShareSyncActionOption.buildOption(e.props.folder,n,t,s.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE)})},t.prototype.renderSyncCoachmark=function(){var e=this.props.sharePermission.canSyncToDropboxRoles.length>0;return this.props.showSyncCoachmark&&e?r.createElement("div",{className:"sync-button__coachmark-container"},r.createElement(a.SharingSyncCoachmark,null)):null},t.prototype.renderSyncButton=function(){var e=this;if(""!==this.props.shareToken.subPath)return null;if(0===this.props.sharePermission.canSyncToDropboxRoles.length)return null;var t="button-primary control__button sync-button";if(this.props.outOfQuota)return r.createElement("a",{className:t,href:"/pro/buy"},u._("Upgrade to Add Folder"));var n=u._("Add to Dropbox"),o=this.getSyncOptions();if(1===o.length)return r.createElement("button",{className:t,onClick:function(t){return e.onClickedOption(t,o[0])}},n);var i=r.createElement("button",{className:t},n);return r.createElement(d,{targetButton:i,folder:this.props.folder,shareToken:this.props.shareToken,options:o})},t.prototype.render=function(){return r.createElement("div",null,this.renderSyncCoachmark(),this.renderSyncButton())},t})(r.Component);t.ShareSyncButton=p}),define("modules/clean/react/share_sync/models",["require","exports","tslib","external/immutable","modules/clean/react/share_sync/actions","modules/core/i18n"],function(e,t,n,r,o,i){"use strict";var s={text:void 0,handler:void 0,isDisabled:!1,spriteName:void 0},a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.buildOption=function(e,n,r,s){var a=i._("Save to my Dropbox"),l="dropbox";if(n.is_paired)switch(r){case"personal":a=i._("Save to personal Dropbox"),l="s_house";break;case"work":a=i._("Save to %(team_name)s Dropbox").format({team_name:n.team_name}),l="s_briefcase"}return new t({text:a,handler:function(){o.syncToDropbox(e.shared_folder_id,r,s)},spriteName:l})},t})(r.Record(s));t.ShareSyncActionOption=a}),define("modules/clean/react/shared_link/actions",["require","exports","modules/clean/sharing/api/client","modules/clean/sharing/delete_link_modal","modules/core/browser"],function(e,t,n,r,o){"use strict";function i(e,t,o){return new Promise(function(i,s){return r.deleteLinkWithConfirmLegacy({client:new n.ShareApiClient({userId:e}),contentName:o,onCancel:s,onDeleteLink:i,tkey:t})})}function s(e,t,n){return i(e,t,n).then(function(){return o.redirect("/home")})}t.removeLink=i,t.removeLinkAsNonOwner=s}),define("modules/clean/react/shared_link_folder/actions",["require","exports","modules/clean/history","modules/clean/react/shared_link_folder/api","modules/clean/react/shared_link_folder/constants","modules/clean/react/shared_link_folder/dispatcher","modules/core/browser","modules/core/uri"],function(e,t,n,r,o,i,s,a){"use strict";function l(e){g("preview",e.filename)}function c(){y("preview")}function u(e){var t=a.parse(e.href);"lst"in m().getQuery()&&t.updateQuery({lst:""}),s.redirect(t.toString())}function d(){g("lst","")}function p(){y("lst")}function h(e,t,n,r,s,a){i.sharedLinkFolderDispatcher.dispatch({type:o.SharedLinkFolderAction.InitializeFolder,data:{files:e,fileSharePermissions:t,fileShareTokens:n,fileSharedLinkInfos:r,folders:s,takedownRequestType:a}})}function _(e){function t(n){i.sharedLinkFolderDispatcher.dispatch({type:o.SharedLinkFolderAction.FetchPageSuccess,data:n}),n.hasMoreEntries?r.fetchNextPage(e,n.nextRequestVoucher).then(t):i.sharedLinkFolderDispatcher.dispatch({type:o.SharedLinkFolderAction.LoadEnd})}i.sharedLinkFolderDispatcher.dispatch({type:o.SharedLinkFolderAction.LoadStart}),r.fetchFirstPage(e).then(t)}function m(){var e=a.parse(n.get_url());return e.setPath(a.encode_parts(e.getPath())),e}function f(e){n.push_state(e.getPath(),e.getQuery())}function g(e,t){var n={};n[e]=t;var r=m();r.updateQuery(n),f(r)}function y(e){var t=m();t.removeQuery(e),f(t)}t.openFile=l,t.closeFile=c,t.openFolder=u,t.enableListMode=d,t.disableListMode=p,t.initializeFolder=h,t.loadFolder=_}),define("modules/clean/react/shared_link_folder/app",["require","exports","tslib","external/react","external/underscore","modules/clean/history","modules/clean/react/file_viewer/actions","modules/clean/react/file_viewer/file_viewer","modules/clean/react/open_in_app/actions","modules/clean/react/pass/utils","modules/clean/react/previews/constants","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/page","modules/clean/react/shared_link_folder/store","modules/clean/react_logger","modules/constants/python","modules/core/browser","modules/core/exception","modules/core/uri"],function(e,t,n,r,o,i,s,a,l,c,u,d,p,h,_,m,f,g,y){"use strict";var v=(function(e){function t(t){var n=e.call(this,"SharedLinkFolderApp",t)||this;n.onUpdateFromStore=function(){if(n.setState(n.getStateFromStore()),n.state.isViewingFile){var e=y.parse(f.get_href()),t=e.getQuery(),r=t.preview;setTimeout(function(){n.setupFileViewer(r)},0)}},n.onLocationChange=function(e,t){var r=t.preview,i={isViewingFile:!!r,shouldForceListMode:"lst"in t};i.isViewingFile&&!n.state.isViewingFile&&n.setupFileViewer(r),o.isMatch(n.state,i)||n.setState(i)};var r=[],i=[],s=[],a=[],l=[];return n.props.contents&&(r=n.props.contents.files,i=n.props.contents.fileSharePermissions,s=n.props.contents.fileShareTokens,a=n.props.contents.fileSharedLinkInfos,l=n.props.contents.folders),n.state={isViewingFile:!1,shouldForceListMode:!1,files:r,fileSharePermissions:i,fileShareTokens:s,fileSharedLinkInfos:a,folders:l,isLoading:!1,takedownRequestType:n.props.takedownRequestType},n.hasAlreadyRendered=!1,n}return n.__extends(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this);var t=y.parse(f.get_href());if(this.onLocationChange(t.getPath(),t.getQuery()),this.props.folderPassOnboardingInfo&&c.PassOnboardingHelpers.setOnboardingInfo(this.props.folderPassOnboardingInfo),this.props.openImmediatelyInApp&&this.openImmediatelyInApp(),this.unsubscribe=h.sharedLinkFolderStore.addListener(this.onUpdateFromStore),this.props.contents){var n=this.props.contents,r=n.files,o=n.fileSharePermissions,i=n.fileShareTokens,s=n.fileSharedLinkInfos,a=n.folders;d.initializeFolder(r,o,i,s,a,this.props.takedownRequestType)}else d.loadFolder(this.props.folderShareToken)},t.prototype.componentWillUnmount=function(){this.unsubscribe()},t.prototype.getStateFromStore=function(){return{files:h.sharedLinkFolderStore.getFiles(),fileSharedLinkInfos:h.sharedLinkFolderStore.getFileSharedLinkInfos(),fileShareTokens:h.sharedLinkFolderStore.getFileShareTokens(),fileSharePermissions:h.sharedLinkFolderStore.getFileSharePermissions(),folders:h.sharedLinkFolderStore.getFolders(),isLoading:h.sharedLinkFolderStore.getIsLoading(),takedownRequestType:h.sharedLinkFolderStore.getTakedownRequestType()}},t.prototype.openImmediatelyInApp=function(){try{this.props.folder.open_in_app_data&&l.openImmediately(this.props.folder.open_in_app_data)}catch(e){}},t.prototype.componentDidMount=function(){i.add_callback("/sh",this.onLocationChange,!0),i.add_callback("/scl",this.onLocationChange,!0),this.hasAlreadyRendered=!0,e.prototype.componentDidMount.call(this)},t.prototype.setupFileViewer=function(e){var t,n,r,i,a,l;if(a=o.find(this.state.files,function(t){return t.filename===e}))t=this.state.files,n=this.state.fileSharePermissions,r=this.state.fileShareTokens,i=this.state.fileSharedLinkInfos,l=t.indexOf(a);else{g.assert(!!this.props.preview,"no preview data available");var c=this.props.preview;a=c.file,g.assert(a.filename===e,"preview data does not match desired file"),t=[a],n=[c.sharePermission],r=[c.shareToken],i=[c.sharedLinkInfo],l=0}s.setup(t,l,this.props.user,{sharedLinkInfos:i,shareTokens:r,sharePermissions:n})},t.prototype.render=function(){if(this.state.isViewingFile){var e=this.hasAlreadyRendered?u.PreviewSourceAction.CLICK:u.PreviewSourceAction.VISIT;return r.createElement(a.FileViewer,{accountMenuOptions:this.props.accountMenuOptions,activityContext:this.props.activityContext,fileViewOrigin:this.props.fileViewOrigin,fileViewTarget:this.props.fileViewTarget,fileViewAction:m.FileViewActionType.CLICK,initialPreviewSourceContext:u.PreviewSourceContext.SHARED_LINK_FOLDER,initialPreviewSourceAction:e,skipOuterRouting:!0,canClose:!0,onCloseViewer:d.closeFile})}var t={files:this.state.files,folders:this.state.folders};return r.createElement(p.SharedLinkFolderPage,{accountMenuOptions:this.props.accountMenuOptions,folder:this.props.folder,folderSharedLinkInfo:this.props.folderSharedLinkInfo,folderShareToken:this.props.folderShareToken,folderSharePermission:this.props.folderSharePermission,isLoading:this.state.isLoading,contents:t,user:this.props.user,outOfQuota:this.props.outOfQuota,shouldForceListMode:this.state.shouldForceListMode,showSyncCoachmark:this.props.showSyncCoachmark,takedownRequestType:this.state.takedownRequestType,membershipRequestOptions:this.props.membershipRequestOptions})},t})(_.ReactLogger);t.SharedLinkFolderApp=v}),define("modules/clean/react/shared_link_folder/controls",["require","exports","tslib","external/classnames","external/react","external/underscore","modules/clean/react/account_menu/account_menu","modules/clean/react/file_action_button","modules/clean/react/deprecated/copyright_flag","modules/clean/react/open_in_app/button","modules/clean/react/share_download/button","modules/clean/react/share_sync/button","modules/clean/react/shared_link/actions","modules/clean/react/shared_link_folder/more_dropdown","modules/clean/react/title_bar/controls_container","modules/clean/react/user_notifications/dropdown","modules/clean/react/user_notifications/constants","modules/clean/viewer","modules/constants/file_viewer","modules/core/browser","modules/core/i18n","modules/core/uri"],function(e,t,n,r,o,i,s,a,l,c,u,d,p,h,_,m,f,g,y,v,b,w){"use strict";var k=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.removeShareLink=function(e){e.preventDefault();var n=t.props.sharePermission.canRemoveLinkUids[0],r=t.props.shareToken.linkKey,o=t.props.shareToken.displayName;p.removeLinkAsNonOwner(n,r,o)},t}return n.__extends(t,e),Object.defineProperty(t.prototype,"canRemoveLink",{get:function(){return this.props.sharePermission.canRemoveLinkUids.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canSyncToDropbox",{get:function(){return this.props.sharePermission.canSyncToDropboxRoles.length>0},enumerable:!0,configurable:!0}),t.prototype.renderSyncButton=function(){if(this.canSyncToDropbox)return o.createElement(d.ShareSyncButton,{folder:this.props.folder,outOfQuota:this.props.outOfQuota,sharedLinkInfo:this.props.sharedLinkInfo,sharePermission:this.props.sharePermission,shareToken:this.props.shareToken,showSyncCoachmark:this.props.showSyncCoachmark})},t.prototype.renderDownloadButton=function(){return o.createElement(u.ShareDownloadButton,{fileOrFolder:this.props.folder,sharedLinkInfo:this.props.sharedLinkInfo,shareToken:this.props.shareToken,sharePermissions:this.props.sharePermission,isMaestroDesign:y.MAESTRO_ENABLED})},t.prototype.renderDivider=function(){if(this.props.user)return o.createElement("div",{className:"react-title-bar__divider"})},t.prototype.renderUserNotificationsDropdown=function(){if(this.props.user)return o.createElement(m.UserNotificationsDropdown,{isPagelet:!1,isMaestroDesign:y.MAESTRO_ENABLED,bellDesign:f.BellDesignTypes.GRAY_ICON})},t.prototype.shouldShowOpenInAppButton=function(){return!!this.props.folder.open_in_app_data},t.prototype.renderOpenInAppButton=function(){return this.shouldShowOpenInAppButton()?o.createElement(c.OpenInAppButton,{urls:this.props.folder.open_in_app_data}):null},t.prototype.renderReportFlag=function(){return this.props.sharedLinkInfo.hasPublicAudienceOrVisibility!==!1?o.createElement(l.CopyrightFlag,{shareToken:this.props.shareToken}):null},t.prototype.renderUserControls=function(){return this.props.user?this.renderAccountMenu():this.renderSignIn()},t.prototype.renderAccountMenu=function(){var e=i.extend({},this.props.accountMenuOptions,{isAccountPhotoEnabled:!0,isToolbarAccountPhotoEnabled:!0,user:this.props.user,viewer:g.get_viewer()});return o.createElement(s.AccountMenu,n.__assign({},e))},t.prototype.renderSignIn=function(){var e=new w({path:"/login",query:{cont:v.get_href()}}),t=r({"button-primary":!this.shouldShowOpenInAppButton(),"button-secondary":this.shouldShowOpenInAppButton()},"sign-in-link","control__button");return o.createElement("a",{className:t,href:e.toString()},b._("Sign in"))},t.prototype.renderMoreButton=function(){if(this.canRemoveLink)return o.createElement(h.MoreDropdown,null,o.createElement(a.FileActionButton,{className:"more-button__remove",type:a.FileActionButtonType.REMOVE_LINK,callback:this.removeShareLink,isMaestroDesign:y.MAESTRO_ENABLED}))},t.prototype.render=function(){return y.MAESTRO_ENABLED?o.createElement(_.TitleBarControlsContainer,null,this.renderReportFlag(),this.renderOpenInAppButton(),this.renderUserControls(),this.renderSyncButton(),this.renderDownloadButton(),this.renderMoreButton(),this.renderDivider(),this.renderUserNotificationsDropdown()):o.createElement(_.TitleBarControlsContainer,null,this.renderReportFlag(),this.renderUserNotificationsDropdown(),this.renderOpenInAppButton(),this.renderUserControls(),this.renderSyncButton(),this.renderDownloadButton(),this.renderMoreButton())},t})(o.Component);k.displayName="SharedLinkFolderControls",t.SharedLinkFolderControls=k}),define("modules/clean/react/shared_link_folder/file_gallery",["require","exports","tslib","external/react","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/gallery","modules/clean/react/thumbnail","modules/clean/react_logger","modules/constants/shared_link_folder"],function(e,t,n,r,o,i,s,a,l){"use strict";var c=(function(e){function t(n){return e.call(this,t.displayName,n)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.files.map(function(e){return r.createElement(i.SharedLinkFolderGalleryCell,{key:e.filename},r.createElement(d,{file:e}))});return r.createElement(u,null,r.createElement(i.SharedLinkFolderGallery,null,e))},t})(a.ReactLogger);c.displayName="SharedLinkFolderFileGallery",t.SharedLinkFolderFileGallery=c;var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-file-gallery-container"},this.props.children)},t})(r.Component);u.displayName="FileGalleryContainer";var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.preventDefault(),o.openFile(t.props.file)},t}return n.__extends(t,e),t.prototype.render=function(){var e,t="video"===this.props.file.preview_type;return t&&(e=r.createElement("div",{className:"sl-video-watermark"})),r.createElement("a",{href:this.props.file.href,onClick:this.onClick,className:"sl-file-link"},r.createElement("div",{className:"sl-file-gallery-thumbnail-container"},r.createElement(s.Thumbnail,{alt:this.props.file.filename,className:"sl-file-gallery-thumbnail",file:this.props.file,shouldFadeIn:l.THUMBNAIL_IMAGE_FADE_IN}),e))},t})(r.Component);d.displayName="GalleryFile"}),define("modules/clean/react/shared_link_folder/folder_gallery",["require","exports","tslib","external/react","modules/clean/em_string","modules/clean/filepath","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/gallery","modules/clean/react_logger","modules/clean/react/sprite"],function(e,t,n,r,o,i,s,a,l,c){"use strict";var u=(function(e){function t(n){return e.call(this,t.displayName,n)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.folders.map(function(e){return r.createElement(a.SharedLinkFolderGalleryCell,{key:e.filename},r.createElement(p,{folder:e}))});return r.createElement(d,null,r.createElement(a.SharedLinkFolderGallery,null,e))},t})(l.ReactLogger);u.displayName="SharedLinkFolderFolderGallery",t.SharedLinkFolderFolderGallery=u;var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-folder-gallery-container"},this.props.children)},t})(r.Component);d.displayName="FolderGalleryContainer";var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.preventDefault(),s.openFolder(t.props.folder)},t}return n.__extends(t,e),t.prototype.getTruncatedName=function(){return o.em_snippet(this.props.folder.filename,20)},t.prototype.render=function(){return r.createElement("a",{href:this.props.folder.href,onClick:this.onClick},r.createElement("div",{className:"o-flag"},r.createElement("div",{className:"o-flag__fix"},r.createElement(c,{group:"web",name:i.folder_icon({size:i.ICON_SIZES.LARGE}),className:"icon",alt:this.props.folder.filename})),r.createElement("div",{className:"o-flag__flex"},this.getTruncatedName())))},t})(r.Component);p.displayName="GalleryFolder"}),define("modules/clean/react/shared_link_folder/gallery",["require","exports","tslib","external/react"],function(e,t,n,r){"use strict";var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement(i,null,r.createElement(s,null,this.props.children))},t})(r.Component);o.displayName="SharedLinkFolderGallery",t.SharedLinkFolderGallery=o;var i=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-gallery-container"},this.props.children)},t})(r.Component);i.displayName="GalleryContainer";var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("ol",{className:"sl-gallery-body clearfix"},this.props.children)},t})(r.Component);s.displayName="GalleryBody";var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("li",{className:"sl-gallery-cell"},this.props.children)},t})(r.Component);a.displayName="SharedLinkFolderGalleryCell",t.SharedLinkFolderGalleryCell=a}),define("modules/clean/react/shared_link_folder/list",["require","exports","tslib","external/react","modules/clean/datetime","modules/clean/display_format","modules/clean/em_string","modules/clean/react/css","modules/clean/react/icon","modules/clean/react/shared_link_folder/actions","modules/clean/react/thumbnail","modules/clean/react_logger","modules/constants/file_viewer","modules/core/i18n","modules/core/uri"],function(e,t,n,r,o,i,s,a,l,c,u,d,p,h,_){"use strict";var m=(function(e){function t(n){return e.call(this,t.displayName,n)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props.entries.map(function(e){return e.is_dir?r.createElement(b,{key:e.filename,folder:e}):r.createElement(w,{key:e.filename,file:e})})
;return r.createElement(f,null,r.createElement(g,null),r.createElement(y,null,e))},t})(d.ReactLogger);m.displayName="SharedLinkFolderList",t.SharedLinkFolderList=a(m,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css"]);var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-list-container"},this.props.children)},t})(r.Component);f.displayName="ListContainer";var g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-list-header"},r.createElement("div",{className:"sl-list-row clearfix"},r.createElement("div",{className:"sl-list-column sl-list-column--filename"},h._("Name")),!p.MAESTRO_ENABLED&&r.createElement("div",{className:"sl-list-column sl-list-column--filesize"},h._("Size",{comment:"byte size on disk"})),r.createElement("div",{className:"sl-list-column sl-list-column--modified"},h._("Modified",{comment:"label for last modified time"}))))},t})(r.Component);g.displayName="ListHeader";var y=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("ol",{className:"sl-list-body o-list-ui o-list-ui--dividers"},this.props.children)},t})(r.Component);y.displayName="ListBody";var v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){e.preventDefault(),t.props.onClick()},t}return n.__extends(t,e),t.prototype.getName=function(){return s.em_snippet(this.props.name,40)},t.prototype.getSize=function(){return this.props.bytes?i.format_bytes(this.props.bytes):"--"},t.prototype.getLastModified=function(){var e=this.props.lastModified;return p.MAESTRO_ENABLED?e?o.format_date(e,o.localized_datetime_format):"--":e?o.ago(e):"--"},t.prototype.render=function(){return r.createElement("li",{className:"sl-list-row clearfix"},r.createElement("div",{className:"sl-list-column sl-list-column--filename"},r.createElement("a",{href:this.props.href,onClick:this.onClick,className:"sl-file-link"},r.createElement("div",{className:"o-flag"},r.createElement("div",{className:"o-flag__fix"},this.props.icon),r.createElement("div",{className:"o-flag__flex"},this.getName())))),!p.MAESTRO_ENABLED&&r.createElement("div",{className:"sl-list-column sl-list-column--filesize"},this.getSize()),r.createElement("div",{className:"sl-list-column sl-list-column--modified"},this.getLastModified()))},t})(r.Component);v.displayName="ListItem";var b=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderIcon=function(){return r.createElement(l.FolderIcon,null)},t.prototype.render=function(){var e=this,t=_.parse(this.props.folder.href).updateQuery({lst:""}),n=t.toString();return r.createElement(v,{icon:this.renderIcon(),name:this.props.folder.filename,href:n,onClick:function(){return c.openFolder(e.props.folder)}})},t})(r.Component);b.displayName="FolderListItem";var w=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderIcon=function(){return r.createElement(u.ThumbnailIcon,{alt:this.props.file.filename,file:this.props.file})},t.prototype.render=function(){var e=this;return r.createElement(v,{icon:this.renderIcon(),name:this.props.file.filename,bytes:this.props.file.bytes,lastModified:new Date(1e3*this.props.file.ts),href:this.props.file.href,onClick:function(){return c.openFile(e.props.file)}})},t})(r.Component);w.displayName="FileListItem"}),define("modules/clean/react/shared_link_folder/more_dropdown",["require","exports","tslib","external/react","modules/clean/react/bubble_menu","modules/clean/react/file_viewer/more_dropdown/icon","modules/clean/react/sprite","modules/clean/react/title_bubble","modules/constants/file_viewer","modules/core/i18n"],function(e,t,n,r,o,i,s,a,l,c){"use strict";var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getMenuItems=function(){var e;return e=this.props.children instanceof Array?this.props.children:[this.props.children],e.filter(function(e){return!!e})},t.prototype.renderButton=function(e){var t=(void 0===e?{}:e).isDisabled,n=void 0!==t&&t;return l.MAESTRO_ENABLED?r.createElement("button",{className:"more-button sprite-button",disabled:n,"aria-label":c._("More actions")},r.createElement(i.MoreDropdownIcon,null)):r.createElement("button",{className:"button-secondary control__button more-button",disabled:n},r.createElement(s,{group:"web",name:"control_more",alt:c._("More actions")}))},t.prototype.renderDisabledMenu=function(){return this.renderButton({isDisabled:!0})},t.prototype.renderMenu=function(e){return r.createElement(a,{content:c._("More"),distanceFromTarget:this.props.tooltipOffset,isTargetPositionFixed:!0,position:this.props.tooltipPosition},r.createElement(o.BubbleMenu,{className:"react-file-viewer-dropdown react-file-viewer-more-dropdown",items:e,position:this.props.menuPosition,targetButton:this.renderButton(),targetFixed:!0,verticalDisplacement:this.props.menuOffset}))},t.prototype.render=function(){var e=this.getMenuItems();return r.createElement("div",{className:"u-mar-left-xs"},e.length>0?this.renderMenu(e):this.renderDisabledMenu())},t})(r.Component);u.displayName="MoreDropdown",u.defaultProps={menuOffset:4,menuPosition:o.BubbleMenu.POSITIONS.BOTTOM_ALIGN_RIGHT,tooltipOffset:10,tooltipPosition:a.POSITIONS.BOTTOM},t.MoreDropdown=u}),define("modules/clean/react/shared_link_folder/page",["require","exports","tslib","external/react","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/browse/sort_helpers","modules/clean/react/css","modules/clean/em_string","modules/clean/react/pass/onboarding_modal_util","modules/clean/react/pass/onboarding_store","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/file_gallery","modules/clean/react/shared_link_folder/folder_gallery","modules/clean/react/shared_link_folder/grid","modules/clean/react/shared_link_folder/list","modules/clean/react/shared_link_folder/view_toggle","modules/clean/react/shared_link_folder/title_bar","modules/clean/react/takedown_warning","modules/clean/react_logger","modules/clean/sharing/constants","modules/clean/static_urls","modules/clean/teams/membership_request_block","modules/clean/web_timing_logger","modules/constants/file_viewer","modules/constants/python","modules/core/i18n","modules/core/uri"],function(e,t,n,r,o,i,s,a,l,c,u,d,p,h,_,m,f,g,y,v,b,w,k,S,x,E,C,T){"use strict";function L(e){return O.indexOf(e.preview_type)>=0}function N(e,t){return s.compare(e.sort_key,t.sort_key,1)}var O=["photo","video"],F=(function(e){function t(n){var r=e.call(this,t.displayName,n)||this;return r.state={viewMode:r.getViewMode(n.shouldForceListMode)},r}return n.__extends(t,e),t.prototype.componentDidMount=function(){u.PassOnboardingStore.shouldShowOnboarding()&&c.OnboardingModalUtil.raisePassOnboardingModal(this.props.user,this.props.folder,this.props.folderSharedLinkInfo),this.ensureWebTimingMarked(),this.logSclTiming(),e.prototype.componentDidMount.call(this)},t.prototype.componentWillReceiveProps=function(e){this.setState({viewMode:this.getViewMode(e.shouldForceListMode)})},t.prototype.componentDidUpdate=function(){this.ensureWebTimingMarked()},t.prototype.ensureWebTimingMarked=function(){var e=this.props.contents,t=e.files,n=e.folders,r=!this.props.isLoading,o=t.length>0||n.length>0;(r||o)&&(S.mark_time_to_view(),S.mark_time_to_interactive())},t.prototype.logSclTiming=function(){if(this.props.user&&this.props.folderShareToken.linkType===b.TOKEN_LINK_TYPE.SHARED_CONTENT_LINK){var e=(new Date).getTime(),t={ns_id:this.props.folder.shared_folder_id,timing:e-S.start_time()};o.ShareTibEventLogger.log(this.props.user.id,"PREVIEW_RENDER",b.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,t)}},t.prototype.getViewMode=function(e){return e||!this.isViewToggleAllowed()&&!x.MAESTRO_ENABLED?f.ViewMode.List:f.ViewMode.Gallery},t.prototype.getTakedownWarning=function(){if(this.props.takedownRequestType)return r.createElement("div",{className:"sl-takedown-warning"},r.createElement(y,{type:this.props.takedownRequestType}))},t.prototype.getTitle=function(){return l.em_snippet(this.props.folderShareToken.displayName,35)},t.prototype.getContentOwner=function(){var e=this.props.folderSharedLinkInfo,t=e.ownerName,n=e.ownerTeamName,o=e.ownerTeamLogo;if(n){var i;if(o){var s=new T({scheme:"https",authority:"www.dropbox.com",path:"/business",query:{src:"schmodel"}});i=r.createElement("span",null," via ",r.createElement("a",{href:s.toString()},E.TRADEMARK_BUSINESS))}var a="";return a=t?C._("from %(owner)s (%(team)s)").format({owner:t,team:n}):C._("from %(team)s").format({team:n}),r.createElement("span",{className:"sl-title-owner"}," ",a,i)}},t.prototype.getMediaFiles=function(e){return(e||this.props.contents.files).filter(L)},t.prototype.getNonMediaFiles=function(){return this.props.contents.files.filter(function(e){return!L(e)})},t.prototype.isViewToggleAllowed=function(){return this.getMediaFiles().length>0},t.prototype.getGalleryFiles=function(){return this.state.viewMode===f.ViewMode.Gallery?this.getMediaFiles():[]},t.prototype.getGalleryFolders=function(){return this.state.viewMode===f.ViewMode.Gallery?this.props.contents.folders:[]},t.prototype.getListFiles=function(){return this.state.viewMode===f.ViewMode.Gallery?this.getNonMediaFiles():this.props.contents.files},t.prototype.getListFolders=function(){return this.state.viewMode===f.ViewMode.List?this.props.contents.folders:[]},t.prototype.getEntries=function(){if(x.MAESTRO_ENABLED){return(new Array).concat(this.props.contents.folders).concat(this.props.contents.files).sort(N)}return(new Array).concat(this.getListFolders()).concat(this.getListFiles())},t.prototype.getContentsCount=function(){return this.props.contents.folders.length+this.props.contents.files.length},t.prototype.getGlobalViewToggle=function(){return this.isViewToggleAllowed()&&!x.MAESTRO_ENABLED?r.createElement(f.FolderViewToggle,{viewMode:this.state.viewMode}):null},t.prototype.getViewToggleOption=function(){return this.state.viewMode===f.ViewMode.Gallery?r.createElement(f.FolderViewToggleOption,{isSelected:!1,icon:"list_light",iconSelected:"list_dark",label:C._("View as list"),onClick:d.enableListMode}):r.createElement(f.FolderViewToggleOption,{isSelected:!1,icon:"grid_light",iconSelected:"grid_dark",label:C._("View as gallery"),onClick:d.disableListMode})},t.prototype.getBody=function(){if(0===this.getContentsCount()&&!this.props.isLoading)return r.createElement(q,null);var e,t,n,o;if(x.MAESTRO_ENABLED){var i=this.getEntries();return this.state.viewMode===f.ViewMode.Gallery?n=r.createElement(_.SharedLinkFolderGrid,{entries:i}):o=r.createElement(m.SharedLinkFolderList,{entries:i}),r.createElement(D,null,n,o,this.getViewToggleOption())}var s=this.getGalleryFiles(),a=this.getGalleryFolders(),i=this.getEntries();return a.length>0&&(e=r.createElement(h.SharedLinkFolderFolderGallery,{folders:a})),s.length>0&&(t=r.createElement(p.SharedLinkFolderFileGallery,{files:s})),i.length>0&&(o=r.createElement(m.SharedLinkFolderList,{entries:i})),r.createElement(D,null,e,t,o)},t.prototype.getLoadingIndicator=function(){var e;return this.props.isLoading&&(e=r.createElement("div",{className:"sl-loading-indicator"},r.createElement(i,{style:i.LoadingIndicatorStyle.BLUE_SPINNER}))),e},t.prototype.render=function(){return r.createElement(I,null,r.createElement(P,null,r.createElement(g.SharedLinkFolderTitleBar,{accountMenuOptions:this.props.accountMenuOptions,folder:this.props.folder,outOfQuota:this.props.outOfQuota,sharedLinkInfo:this.props.folderSharedLinkInfo,shareToken:this.props.folderShareToken,sharePermission:this.props.folderSharePermission,showSyncCoachmark:this.props.showSyncCoachmark,user:this.props.user})),r.createElement(M,null,r.createElement(A,null,r.createElement(R,null,this.getTakedownWarning(),this.getTitle(),this.getContentOwner()),this.getGlobalViewToggle()),this.getBody(),this.getLoadingIndicator()),r.createElement(k.MembershipRequestBlock,{membershipRequestOptions:this.props.membershipRequestOptions}))},t})(v.ReactLogger);F.displayName="SharedLinkFolderPage",F.defaultProps={shouldForceListMode:!1},t.SharedLinkFolderPageWithoutCss=F,t.SharedLinkFolderPage=a(F,["/static/css/react_title_bar-vflSiemjs.css","/static/css/react_file_viewer-vflQ2VwT_.css"]);var I=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-page-container"},this.props.children)},t})(r.Component);I.displayName="PageContainer";var P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-page-header"},this.props.children)},t})(r.Component);P.displayName="PageHeader";var M=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-page-body"},this.props.children)},t})(r.Component);M.displayName="PageBody";var A=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-header clearfix"},this.props.children)},t})(r.Component);A.displayName="FolderHeader";var R=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("h3",{className:"sl-title"},this.props.children)},t})(r.Component);R.displayName="FolderTitle";var D=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-body"},this.props.children)},t})(r.Component);D.displayName="FolderBody";var q=(function(e){function t(n){return e.call(this,t.displayName,n)||this}return n.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"sl-body sl-body--empty-folder"},r.createElement("img",{className:"sl-empty-folder-icon",src:w.static_url("/static/images/icons128/folder-vfl8tOYL3.png"),alt:""}),r.createElement("h3",{className:"sl-empty-folder-message"},C._("This folder is empty")))},t})(v.ReactLogger);q.displayName="EmptyFolderBody"}),define("modules/clean/react/shared_link_folder/title_bar",["require","exports","tslib","external/react","modules/clean/react/shared_link_folder/controls","modules/clean/react/title_bar/base","modules/clean/react_logger"],function(e,t,n,r,o,i,s){"use strict";var a=(function(e){function t(t){return e.call(this,"SharedLinkFolderTitleBar",t)||this}return n.__extends(t,e),t.prototype.renderControls=function(){return r.createElement(o.SharedLinkFolderControls,{accountMenuOptions:this.props.accountMenuOptions,folder:this.props.folder,outOfQuota:this.props.outOfQuota,sharedLinkInfo:this.props.sharedLinkInfo,shareToken:this.props.shareToken,sharePermission:this.props.sharePermission,showSyncCoachmark:this.props.showSyncCoachmark,user:this.props.user})},t.prototype.render=function(){var e=this.props.sharedLinkInfo&&this.props.sharedLinkInfo.ownerTeamLogo;return r.createElement(i.TitleBarBase,{controls:this.renderControls(),customLogoUrl:e})},t})(s.ReactLogger);t.SharedLinkFolderTitleBar=a}),function(){define("modules/clean/react/takedown_warning",["external/react","modules/clean/react_format","modules/clean/react_logger","modules/constants/python","modules/core/i18n"],function(e,t,n,r,o){var i,s,a,l,c,u,d;return u=t.reactFormat,i=n.ReactLogger,s=r.TakedownRequestTypes,a=o._,d=e.DOM,l=d.a,c=d.div,e.createClass({displayName:"TakedownWarning",propTypes:{type:e.PropTypes.number},componentWillMount:function(){return i.start(this.constructor.displayName)},componentDidMount:function(){return i.end(this.constructor.displayName)},_getWarningMessage:function(){switch(this.props.type){case s.DMCA:return u(a("Certain files in this folder can’t be shared due to a takedown request in accordance with the DMCA. <a>Learn more</a>"),{a:l({target:"_top",href:"/help/210"})});default:return u(a("Certain files in this folder are unavailable. For more information <a>contact Dropbox support</a>."),{a:l({target:"_top",href:"/ticket"})})}},render:function(){return c({className:"notify server-success"},this._getWarningMessage())}})})}.call(this),function(){define("modules/clean/react/thumbnail",["external/classnames","external/react","external/underscore","modules/clean/photos/thumb_store","modules/clean/react/icon","modules/clean/react/sprite","modules/clean/static_urls","modules/constants/python","modules/core/uri"],function(e,t,n,r,o,i,s,a,l){var c,u,d,p,h,_,m,f,g,y,v,b,w,k;return u=o.FileIcon,o.ICON_SIZES,b=s.static_url,h=a.THUMBNAIL_SIZE_MODE,c=b("/static/images/preview_fail-vflc3IDxf.png"),d=b("/static/images/icons/ajax-loading-small-blue-vflm7vRcz.gif"),p="178x178",v=t.DOM.img,g=t.createElement,w=new r,f=t.PropTypes.shape({isLoading:t.PropTypes.bool.isRequired,src:t.PropTypes.string}),_=t.createClass({displayName:"Thumbnail",propTypes:{alt:t.PropTypes.string.isRequired,className:t.PropTypes.string,thumbnail:f.isRequired,onClick:t.PropTypes.func,shouldFadeIn:t.PropTypes.bool},_getSrc:function(){return this.props.thumbnail.src?this.props.thumbnail.src:this.props.thumbnail.isLoading?this.props.shouldFadeIn?void 0:d:c},_getAlt:function(){return this.props.shouldFadeIn?this.props.thumbnail.isLoading?"":this.props.alt:this.props.alt},render:function(){var t,n,r;return r={},r[""+this.props.className]=null!=this.props.className,t=r,this.props.shouldFadeIn&&(t["thumbnail-image"]=!0,t["thumbnail-image--loaded"]=!this.props.thumbnail.isLoading),t["thumbnail-image--failed"]=!this.props.thumbnail.src&&!this.props.thumbnail.isLoading,n={onClick:this.props.onClick,src:this._getSrc(),alt:this._getAlt(),className:e(t)},v(n)}}),m=t.createClass({displayName:"ThumbnailIcon",propTypes:{alt:t.PropTypes.string.isRequired,className:t.PropTypes.string,file:t.PropTypes.object.isRequired,thumbnail:f.isRequired,iconSize:t.PropTypes.string},render:function(){var t;return this.props.thumbnail.src?(t=["icon","thumbnail-image--loaded",this.props.className],v({alt:this.props.alt,className:e(t),src:this.props.thumbnail.src})):(t=["icon","thumbnail-image--failed",this.props.className],g(u,{alt:this.props.alt,className:e(t),file:this.props.file,size:this.props.iconSize}))}}),y=function(e){var t;if(e)return t=l.parse(e),t.updateQuery("size",p),t.updateQuery("size_mode",h.EXACT),t.toString()},k=function(e){var r,o,i;return r=null!=(o=e.displayName)?o:"UnnamedComponent",i="ThumbnailLoader("+r+")",t.createClass({displayName:i,propTypes:{file:t.PropTypes.shape({thumbnail_url_tmpl:t.PropTypes.string}).isRequired},getInitialState:function(){return this._getStateForTemplateUrl(this.props.file.thumbnail_url_tmpl)},componentDidMount:function(){return this._bindThumbStore()},componentWillReceiveProps:function(e){var t;if(t=e.file.thumbnail_url_tmpl,t!==this.props.file.thumbnail_url_tmpl)return this.setState(this._getStateForTemplateUrl(t))},componentWillUpdate:function(){return this._unbindThumbStore()},componentDidUpdate:function(){return this._bindThumbStore()},componentWillUnmount:function(){return this._unbindThumbStore()},_getStateForTemplateUrl:function(e){var t,n,r;return r=y(e),r&&(n=w.get_thumb(r)),t=Boolean(r)&&!Boolean(n),{isLoading:t,src:n,url:r}},_bindThumbStore:function(){var e;if(this.state.isLoading&&!this._bindingId)return e=this.state.url,this._bindingId=w.bind_url(e,{onSuccess:(function(t){return function(){return t.setState({isLoading:!1,src:w.get_thumb(e)})}})(this),onError:(function(e){return function(){return e.setState({isLoading:!1})}})(this)})},_unbindThumbStore:function(){if(this._bindingId)return w.unbind_url(this._bindingId),delete this._bindingId},render:function(){return g(e,n.extend(n.clone(this.props),{thumbnail:{isLoading:this.state.isLoading,src:this.state.src}}))}})},{Thumbnail:k(_),ThumbnailIcon:k(m)}})}.call(this),function(){define("modules/clean/sharing/notifications",["jquery","modules/clean/browse_interface","modules/clean/sharing/api/client","modules/clean/viewer","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,r,o,i,s,a){var l,c,u,d,p,h;return c=n.ShareApiClient,l=n.FolderShareApiClient,u=i._,d=function(t){var n,r;return n=e(t).closest("form"),null!=(r=n.closest(".sc-invite-action"))&&r.addClass("loading"),n.length&&new c({userId:n[0]._subject_uid.value}).dismissInviteNotification({contentId:n[0].content_id.value}).finally(function(){return n.closest(".sc-invite-action").removeClass("loading"),n.closest(".feed-row").remove()}),!1},p=function(n){var i,c;return i=e(n),i.closest(".sc-invite-action").addClass("loading"),c=r.get_viewer().get_user_by_id(n._subject_uid.value),new l({userId:c.id}).mount({contentId:n.sf_id.value,origin:"NOTIFICATION_WEB"}).then(function(e){var n,r,l;return n=i.closest(".sc-invite-action"),n.addClass("sf-mounted"),r=e.path_lower,l=a({path:t.get_browse_root(c)+r}).toString(),o.redirect(l),s.success(u("Added the shared folder %(folder_name)s.").format({folder_name:e.name}))}).finally(function(){return i.closest(".sc-invite-action").removeClass("loading")}),!1},h=function(){var e;return s.info(u("Continue upgrading to add the shared folder to your Dropbox.")),e=a({scheme:"https",authority:"www.dropbox.com",path:"/pro/buy"}),e.updateQuery({cont:"sf",oqa:"sf_aoq_b_n"}),o.redirect(e.toString()),!1},{register_dismiss:d,register_mount:p,upgrade_to_mount:h}})}.call(this),function(){define("modules/clean/sharing/views/sync_coachmark",["external/react","modules/clean/ajax","modules/clean/react/bubble","modules/clean/react/button","modules/clean/react/css","modules/clean/react/image","modules/clean/static_urls","modules/core/i18n"],function(e,t,n,r,o,i,s,a){var l,c,u,d,p,h;return r.button,r.link_button,h=s.static_url,p=e.DOM,d=e.createElement,c=a.i18n_default_project("sharing")._,u=e.createClass({displayName:"SharingSyncCoachmark",getInitialState:function(){return{show:!0}},componentWillMount:function(){return t.BackgroundRequest({url:"/sharing/seen_sync_coachmark"})},render:function(){return this.state.show?d(n,{arrow:n.ARROW.TOP_RIGHT,className:"sync-coachmark u-pad-s"},d(i,{className:"u-l-ib",src:h("/static/images/sharing/sync_coachmark-vflyzarQZ.png"),srcHiRes:h("/static/images/sharing/sync_coachmark@2x-vflMrQ12G.png")}),p.div({className:"u-l-ib u-pad-left-s sync-coachmark__content"},p.h2({},c("Stay in sync")),p.p({},c("For easy access to this folder in the future, add it to your Dropbox.")),p.button({className:"c-btn c-btn--secondary",onClick:(function(e){return function(){return e.setState({show:!1})}})(this)},c("Got it")))):p.div({})}}),l=o(u,["/static/css/sharing/sync_coachmark-vfl_8vkAL.css"]),{SharingSyncCoachmark:l}})}.call(this),function(){define("modules/clean/teams/limited_team_invite_form",["external/underscore","external/classnames","external/react","modules/core/uri","modules/core/i18n","modules/clean/react_format","modules/clean/ajax","modules/clean/css","modules/clean/contacts/contact","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/react/input","modules/clean/react/modal"],function(e,t,n,r,o,i,s,a,l,c,u,d,p){var h,_,m,f,g,y,v,b,w,k,S,x,E,C,T,L;v=o._,L=o.ungettext,C=i.reactFormat,h=l.Contact,m=c.ContactsTokenizer,_=c.ContactTokenState,p.Modal,w=n.DOM,E=n.PropTypes,f=(function(){function e(){this.inFlight=!0,this.canInvite=!1,this.reason="checking",this.callbacks=[]}return e.prototype.whenReady=function(e){return this.inFlight?this.callbacks.push(e):e()},e.prototype.resultArrived=function(e,t){var n,r,o;if(this.inFlight){for(this.inFlight=!1,this.canInvite=e,this.reason=t,o=this.callbacks,n=0,r=o.length;n<r;n++)o[n]();return delete this.callbacks}},e})(),g=(function(){function e(e){this.checkUrl=e,this.checkedEmails={}}return e.prototype.checkEmails=function(e,t){var n,r,o,i,a,l,c;if(l={},c=e.length,0===c)return t(l);for(o=[],i=0,a=e.length;i<a;i++)r=e[i],n=this.checkedEmails[r],n||(n=this.checkedEmails[r]=new f,o.push(r)),n.whenReady(function(){if(l[r]=n,0===--c)return t(l)});(function(e){return function(t){return s.WebRequest({url:e.checkUrl,data:{emails:t.join(",")},success:function(t){var n,o,i,s,a,l;i=JSON.parse(t),l=[];for(r in i)s=i[r],n=s.can_invite,o=s.reason,l.push(null!=(a=e.checkedEmails[r])?a.resultArrived(n,o):void 0);return l},error:function(){var n,o,i;for(i=[],n=0,o=t.length;n<o;n++)r=t[n],i.push(delete e.checkedEmails[r]);return i}})}})(this)(o)},e.prototype.getEmailCheckResult=function(e){return this.checkedEmails[e]},e})(),y={existingTeam:{id:"existingTeam",checkUrl:"/team/manage/check_can_invite"},createLimitedTeam:{id:"createLimitedTeam",checkUrl:"/team/create_limited/check_can_invite"}},k={};for(x in y)T=y[x],S=T.id,b=T.checkUrl,k[S]=new g(b);return n.createClass({displayName:"LimitedTeamInviteForm",propTypes:{user:E.object.isRequired,invitationContext:E.oneOf(e.values(y)),populatedCustomMessage:E.string,populatedContacts:E.arrayOf(E.instanceOf(h)),customClass:E.string,onChange:E.func,emailPlaceholder:E.string,messagePlaceholder:E.string,errorMessageSpaceFixed:E.bool,emailCheckerStore:E.object,includeCustomMessage:E.bool,autofocusTokenizer:E.bool,memberInviteLimit:E.number,maxTeamSize:E.number,tokenSpacing:E.number,customErrorMessage:E.string},statics:{InvitationContexts:y},getDefaultProps:function(){return{customClass:"",invitationContext:y.existingTeam,populatedContacts:[],emailPlaceholder:v("Name or email"),messagePlaceholder:v("Add a message (optional)"),includeCustomMessage:!0,autofocusTokenizer:!0}},getInitialState:function(){return{errorMessage:null}},componentWillMount:function(){if(a.require_css("/static/css/teams/limited_team_invite_form-vflcSjpys.css"),a.require_css("/static/css/react/contacts_tokenizer-vflR5K70C.css"),this.emailCheckerStore=this.props.emailCheckerStore||k[this.props.invitationContext.id],this.props.populatedContacts.length>0)return this._ensureContactsStateUpdated(this.props.populatedContacts,(function(e){return function(){var t;return e._updateErrorMessage(),"function"==typeof(t=e.props).onChange?t.onChange():void 0}})(this))},getContacts:function(){return this.refs.tokenizer.getContacts()},getFinalData:function(t){var n,r;return this.refs.tokenizer.tokenizeAll(),n=this.getContacts(),this.props.includeCustomMessage&&(r=this.refs.message.getValue()),this._ensureContactsStateUpdated(n,(function(o){return function(){var i,s;return i=e.filter(n,function(e){return e.type===u.EMAIL}),s=e.map(i,function(e){return e.email}),o._updateErrorMessage(),t({emails:s,custom_message:r})}})(this))},areAllContactsValid:function(){var t;return!this._overInviteLimit()&&(t=this.refs.tokenizer.serializeInputData().tokens,0===t.length||e.all(t,(function(e){return function(t){return e._validateContact(t).state===_.ok}})(this)))},isEmpty:function(){var e,t,n;return e=this.refs.tokenizer.serializeInputData(),t=e.tokens,n=e.value,0===t.length&&0===n.length},_ensureContactsStateUpdated:function(t,n){var r;return t=e.filter(t,function(e){return e.type===u.EMAIL&&!e.invalid&&!e.on_team}),r=e.map(t,function(e){return e.email}),this.emailCheckerStore.checkEmails(r,(function(e){return function(){if(e.isMounted())return n()}})(this))},_validateContact:function(e){var t,n;return e.invalid?n={state:_.invalid,msg:v("Invalid email.")}:e.on_team?n={state:_.invalid,msg:v("User is already a member of this team.")}:(t=this.emailCheckerStore.getEmailCheckResult(e.email),n=t?t.inFlight?{state:_.pending}:t.canInvite?{state:_.ok}:{state:_.invalid,msg:(function(){switch(t.reason){case"team_member":return v("This person is already on another team.");case"already_on_this_team":return v("User is already invited to this team.");case"error":return v("User isn’t eligible to join this team.");default:return null}})()}:{state:_.invalid}),n},_overInviteLimit:function(){var e;return e=this.refs.tokenizer.serializeInputData().tokens,null!=this.props.memberInviteLimit&&e.length>this.props.memberInviteLimit},_updateErrorMessage:function(){var e,t,n,o,i,s,a,l,c;for(s=this.refs.tokenizer.serializeInputData().tokens,t=0,n=s.length;t<n;t++)if(e=s[t],a=this._validateContact(e),l=a.state,o=a.msg,l!==_.ok)return void this.setState({errorMessage:o});return this._overInviteLimit()?(i={tk:this.props.maxTeamSize,_camp:"invite"},c=r({path:"/team/upgrade",query:i}),void this.setState({errorMessage:C(L("You have %(num_rem)s invite remaining. <upgradeLink>Upgrade</upgradeLink> now to add as many members as you like to your team.","You have %(num_rem)s invites remaining. <upgradeLink>Upgrade</upgradeLink> now to add as many members as you like to your team.",this.props.memberInviteLimit),{num_rem:this.props.memberInviteLimit,upgradeLink:w.a({href:c.toString()})})})):this.setState({errorMessage:null})},onContentsChange:function(e,t){return this._ensureContactsStateUpdated(e,(function(e){return function(){var t;return e._updateErrorMessage(),"function"==typeof(t=e.props).onChange?t.onChange():void 0}})(this))},render:function(){var e;return e={"limited-team-invite-form":!0,"error-message-fixed":this.props.errorMessageSpaceFixed,"has-custom-message":this.props.includeCustomMessage},this.props.customClass&&(e[this.props.customClass]=!0),w.div({className:t(e)},w.div({className:"error-message u-mar-bottom-xss"},this.props.customErrorMessage||this.state.errorMessage),n.createElement(m,{ref:"tokenizer",user:this.props.user,placeholder:this.props.emailPlaceholder,onContentsChange:this.onContentsChange,autofocus:this.props.autofocusTokenizer,populatedInputData:{tokens:this.props.populatedContacts,value:""},tokenSpacing:this.props.tokenSpacing,customContactValidator:this._validateContact,customContactFilter:(function(e){return function(t){return t.type===u.EMAIL&&!t.team&&t.name&&t.email!==e.props.user.email}})(this)}),this.props.includeCustomMessage?n.createElement(d.textarea,{ref:"message",className:"custom-message","disable-errors":!0,placeholder:this.props.messagePlaceholder,value:this.props.populatedCustomMessage}):void 0)}})})}.call(this),function(){define("modules/clean/teams/membership_request_block",["external/react","jquery","modules/clean/analytics","modules/clean/avatar/triple_avatars","modules/clean/react/button","modules/clean/react/css","modules/clean/react_logger","modules/clean/teams/membership_discovery_util","modules/clean/viewer","modules/constants/python","modules/constants/teams","modules/core/browser","modules/core/cookies","modules/core/i18n","modules/core/notify","modules/core/user_i18n"],function(e,t,n,r,o,i,s,a,l,c,u,d,p,h,_,m){var f,g,y,v,b,w,k,S,x,E,C;return v=n.TeamsWebActionsLogger,b=r.TripleAvatars,o.button,y=s.ReactLogger,E=a.sendTeamRequest,c.TRADEMARK_BUSINESS,S=e.createElement,x=e.DOM,C=l.get_viewer(),f="_MRBD",w=h.i18n_default_project("sharing")._,k=e.createClass({displayName:"MembershipRequestBlock",propTypes:{membershipRequestOptions:e.PropTypes.shape({canRequestToJoin:e.PropTypes.bool,contacts:e.PropTypes.arrayOf(e.PropTypes.object),limited:e.PropTypes.bool,id:e.PropTypes.int,name:e.PropTypes.string,size:e.PropTypes.int})},getDefaultProps:function(){return{membershipRequestOptions:{canRequestToJoin:!1}}},getInitialState:function(){return{isUnloaded:"true"===p.read(f)}},componentWillMount:function(){return y.start(this.constructor.displayName)},componentDidMount:function(){var e,t,n,r,o,i;return i=this.state.isUnloaded,(null!=(e=this.props.membershipRequestOptions)?e.canRequestToJoin:void 0)&&!i&&v.log("magnet_sl_request_to_join_block_open",{user_id:null!=(t=C.personal_user)?t.id:void 0,requested_team_id:null!=(n=this.props.membershipRequestOptions)?n.id:void 0,is_limited:null!=(r=this.props.membershipRequestOptions)?r.limited:void 0,size:null!=(o=this.props.membershipRequestOptions)?o.size:void 0}),
y.end(this.constructor.displayName)},render:function(){var e,t;return(null!=(e=this.props.membershipRequestOptions)?e.canRequestToJoin:void 0)?this.state.isUnloaded?x.div({}):x.div({className:"membership-request-block u-pad-top-m"},x.div({className:"membership-request-block__close",onClick:this.onCloseClick}),x.div({className:"u-mar-top-m"},x.div({className:"membership-request-block__avatars"},S(b,{contacts:this.props.membershipRequestOptions.contacts,count:this.props.membershipRequestOptions.size})),x.div({},x.div({className:"membership-request-block__header u-mar-top-m"},w("Join %(name)s and your coworkers on the %(team_name)s Dropbox team").format({name:null!=(t=this.props.membershipRequestOptions.contacts[0])?t.display_name:void 0,team_name:this.props.membershipRequestOptions.name})),this.props.membershipRequestOptions.limited?x.div({className:"membership-request-block__subheader u-mar-top-xs"}):x.div({className:"membership-request-block__subheader u-mar-top-xs"},w("Unlock business tools and get more space for sharing and collaboration—ask your admin to add you to the %(team_name)s team.").format({team_name:this.props.membershipRequestOptions.name}))),x.button({className:"c-btn c-btn--primary c-btn--big u-mar-top-l",onClick:this.onRequestClick},w(this.props.membershipRequestOptions.limited?"Join the team":"Request to join")))):x.div({})},requestMembership:function(){return E(this.props.membershipRequestOptions.id)},onRequestClick:function(){var e,t,n,r;return v.log("magnet_sl_request_to_join_block",{user_id:null!=(e=C.personal_user)?e.id:void 0,requested_team_id:null!=(t=this.props.membershipRequestOptions)?t.id:void 0,is_limited:null!=(n=this.props.membershipRequestOptions)?n.limited:void 0,size:null!=(r=this.props.membershipRequestOptions)?r.size:void 0}),this.requestMembership(),this.setState({isUnloaded:!0})},onCloseClick:function(){var e,t,n,r;return v.log("magnet_sl_skip_request_to_join_block",{user_id:null!=(e=C.personal_user)?e.id:void 0,requested_team_id:null!=(t=this.props.membershipRequestOptions)?t.id:void 0,is_limited:null!=(n=this.props.membershipRequestOptions)?n.limited:void 0,size:null!=(r=this.props.membershipRequestOptions)?r.size:void 0}),p.create(f,"true"),this.setState({isUnloaded:!0})}}),g=i(k,["/static/css/scooter/scooter-scoped-vfl0UVTY2.css","/static/css/teams/membership_request_block-vfly7tYHH.css"]),{MembershipRequestBlock:g}})}.call(this),function(){define("modules/clean/teams/modals/suggest_team_invite_modal",["external/react","external/underscore","modules/core/html","modules/core/i18n","modules/core/notify","modules/clean/analytics","modules/clean/ajax","modules/clean/contacts/contact","modules/clean/contacts/types","modules/clean/teams/limited_team_invite_form","modules/clean/react/modal","modules/clean/react/input","modules/clean/viewer"],function(e,t,n,r,o,i,s,a,l,c,u,d,p){var h,_,m,f,g,y,v;return g=r._,f=i.TeamsWebActionsLogger,h=a.Contact,_=u.Modal,e.DOM,y=e.PropTypes,v=p.get_viewer(),m=e.createClass({displayName:"SuggestTeamInviteModal",statics:{showIfNeeded:function(n,r){return m.showInviteModal(function(o){return o?m.validateSuggestions(n,function(o){var i;return o.length>0?("function"==typeof r.onCheckCompleted&&r.onCheckCompleted(!0),r=t.extend({},r,{usersSharedOnFolder:n.emails,suggestedUsersToInviteToTeam:o}),i=e.createElement(m,r),_.showInstance(i)):"function"==typeof r.onCheckCompleted?r.onCheckCompleted(!1):void 0}):"function"==typeof r.onCheckCompleted?r.onCheckCompleted(!1):void 0})},validateSuggestions:function(e,t){return s.WebRequest({url:"/team/validate_emails_to_suggest_inviting",data:{emails_to_verify:JSON.stringify(e.emails)},success:function(e){return e=JSON.parse(e),t(e)}})},showInviteModal:function(e){var t;return(null!=(t=v.work_user)?t.is_team:void 0)?m._getShouldShowInviteModalData(function(t){return e(t.isOnLimitedTeam&&!t.hasSeenSuggestTeamInviteModal)}):e(!1)},_getShouldShowInviteModalData:function(e){return s.WebRequest({url:"/team/should_show_invite_modal",success:function(t){return t=JSON.parse(t),e(t)}})}},propTypes:{sharingType:y.string.isRequired,suggestedUsersToInviteToTeam:y.arrayOf(y.string).isRequired,usersSharedOnFolder:y.arrayOf(y.string),teamName:y.string,onDidAccept:y.func,onDidDismiss:y.func,onDidClose:y.func},getDefaultProps:function(){return{onDidAccept:function(){},onDidDismiss:function(){},teamName:v.team_name}},getInitialState:function(){return{canAccept:this.props.suggestedUsersToInviteToTeam.length>0,submitting:!1,errors:null}},_canAccept:function(){var e,t;return(null!=(e=this.refs.members)?e.areAllContactsValid():void 0)&&!(null!=(t=this.refs.members)?t.isEmpty():void 0)},onAccept:function(e){return this.refs.members.getFinalData((function(e){return function(r){var i,a,l;if(l=r.emails,a=r.custom_message,i=e._canAccept(),e.setState({canAccept:i}),i)return e.setState({submitting:!0}),s.WebRequest({url:"/account/team/add_users",subject_user:v.work_user,data:{emails:l,custom_message:a,team_id:v.team_id},complete:function(){if(null!=e.refs.modal)return e.setState({submitting:!1})},success:function(n){var r,i,s,a;return n=JSON.parse(n),s=t.values(n.users),a=void 0,1===s.length?a=g("Member invited."):s.length>1&&(a=g("Members invited.")),a?(o.success(a),f.log("team_member_invited_to_team_while_sharing",{sharing_type:e.props.sharingType,num_users_invited_to_team:null!=l?l.length:void 0}),"function"==typeof(r=e.props).onDidAccept&&r.onDidAccept(),e.refs.modal.close(),"function"==typeof(i=e.props).onDidClose?i.onDidClose():void 0):o.error(g("There was a problem completing this request."))},error:function(e){return"rate-limit"===e.getResponseHeader("x-dropbox-app-error")?o.error(new n(g('%(team_name)s has reached the maximum number of team members allowed on Dropbox Basic. Please <a href="/business/contact">contact sales</a> to add more members to your team.').format({team_name:v.team_name}))):o.error(g("There was a problem completing this request."))}})}})(this))},onDidDismiss:function(){var e,t;return"function"==typeof(e=this.props).onDidDismiss&&e.onDidDismiss(),"function"==typeof(t=this.props).onDidClose?t.onDidClose():void 0},onMembersFormChange:function(){return this.setState({canAccept:this._canAccept()})},componentDidMount:function(){var e,t;return f.log("team_member_saw_suggestions_while_sharing",{sharing_type:this.props.sharingType,num_users_shared:null!=(e=this.props.usersSharedOnFolder)?e.length:void 0,num_users_suggested_to_team:null!=(t=this.props.suggestedUsersToInviteToTeam)?t.length:void 0}),s.WebRequest({url:"/team/saw_suggest_team_invite_modal"})},render:function(){var t,n;return n=function(){var e,n,r,o;for(r=this.props.suggestedUsersToInviteToTeam,o=[],e=0,n=r.length;e<n;e++)t=r[e],o.push(new h({email:t,type:l.EMAIL}));return o}.call(this),e.createElement(_,{className:"suggest-team-invite-modal",title:g("Do you want to invite these people to join your “%(team_name)s” team?").format({team_name:this.props.teamName}),acceptButtonText:g("Invite"),dismissButtonText:g("No thanks"),acceptButtonDisabled:!this.state.canAccept,submitting:this.state.submitting,onAccept:this.onAccept,onDismissCompleted:this.onDidDismiss,autoClose:!1,ref:"modal"},e.createElement(c,{ref:"members",errorMessageSpaceFixed:!0,invitationContext:c.InvitationContexts.existingTeam,onChange:this.onMembersFormChange,user:v.work_user,populatedContacts:n,autofocusTokenizer:!0}))}})})}.call(this),function(){define("modules/clean/top_notif",["jquery","modules/clean/ajax"],function(e,t){var n,r,o,i,s,a,l,c;return l={HIDE_EVENT:"db:topnotificationbar:hide",hide:function(t){var n,r;if(n=null==(r=(null!=t?t:{clearPageletCache:!0}).clearPageletCache)||r,e("#top-notification-bar-container").remove(),e(".top-notification-bar-silo").remove(),e("body").removeClass("top-notification-bar"),e(".maestro .has-top-notification").removeClass("has-top-notification"),e(".maestro #notify-wrapper.with-top-notification").removeClass("with-top-notification"),e(document).trigger(this.HIDE_EVENT),n&&window.ensemble&&window.ensemble.clearPageletCache)return window.ensemble.clearPageletCache()}},r={init:function(){return e(".eu-bar-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_eu_cookie_notification"})})}},i={init:function(){return e(".expired-ios-bar-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_expired_ios_notification"})})}},s={init:function(){return e("#locale-switch-banner-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_locale_switch_banner"})})}},a={init:function(){return e("#super-inactive-recover-bar-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_super_inactive_recover_bar"})})}},c={init:function(){return e("#unsupported-browser-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_browser_msg"})})}},o={init:function(n){return e(".expired-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_expired_cc_notification",data:{source:n}})})}},n={init:function(n){return e(".beta-locale-dismiss").on("click",function(e){return e.preventDefault(),l.hide(),t.SilentBackgroundRequest({url:"/dismiss_beta_locale_notification",data:{source:n}})})}},{TopNotificationBar:l,EUCookieNotificationBar:r,ExpiredIOSNotificationBar:i,LocaleSwitchBar:s,SuperInactiveRecoverBar:a,UnsupportedBrowser:c,ExpiredCCNotificationBar:o,BetaLocaleNotificationBar:n}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/dirty/growth/shared_link_signup_modals",["dropbox","jquery","modules/clean/ajax","modules/clean/sharing/signup_modal_proxy","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/analytics","modules/clean/legacy_pyxl_controllers/login_form","modules/clean/dbmodal","modules/clean/growth/experiments/logger","modules/clean/register_form"],function(t,n,r,o,i,s,a,l,c,u,d,p,h){var _,m,f,g,y;return f=t.SharingModel,y=s._,g=c.WebMiscActivityLogger,_=d.DBModal,m=h.RegisterForm,(function(){function t(t){this.kind=t,this.register_success=e(this.register_success,this),this.show_login_form=e(this.show_login_form,this),this.save_to_dropbox=e(this.save_to_dropbox,this),this.direct_download=e(this.direct_download,this),this.handle_default_modal_cancel=e(this.handle_default_modal_cancel,this),this.handle_default_modal_authenticate=e(this.handle_default_modal_authenticate,this),this.handle_direct_download_cancel=e(this.handle_direct_download_cancel,this),this.handle_direct_download=e(this.handle_direct_download,this),this.on_request_default_signup=e(this.on_request_default_signup,this),this.on_request_direct_download=e(this.on_request_direct_download,this),this.show_create_password_modal=e(this.show_create_password_modal,this),this.show_welcome_modal=e(this.show_welcome_modal,this),this.before_create_password_modal=e(this.before_create_password_modal,this),this.before_download_signup_modal=e(this.before_download_signup_modal,this),this.before_default_signup_modal=e(this.before_default_signup_modal,this),this.before_signup_modal=e(this.before_signup_modal,this),this.init_modals=e(this.init_modals,this),this.init_modals(),o.connectModal(this),"immediate"===this.kind&&(g.log("signup_modal-show-upfront",{auth_google:null!=n.find(".auth-google")}),this.default_signup_modal.show()),"download"!==this.kind?(n("#download_button_link, #default_content_download_button").click(this.direct_download),this.has_seen_modal=!0):n("#download_button_link, #default_content_download_button").click((function(e){return function(){return e.has_seen_modal?e.direct_download():(e.has_seen_modal=!0,g.log("signup_modal-show-download",{auth_google:null!=n.find(".auth-google")}),e.download_type="direct_download",e.download_signup_modal.show())}})(this)),n(".add_to_my_dropbox_link, #default_content_a2md").click((function(e){return function(){return e.download_type="add_to_dropbox",e.download_signup_modal.show()}})(this))}return t.prototype.init_modals=function(){return this.default_signup_modal=new _({element_id:"shared-link-immediate-signup-modal"}),this.default_signup_modal.before_show=this.before_default_signup_modal,this.default_signup_modal.on_hide=(function(e){return function(){if(!e._has_authenticated)return"function"==typeof e._on_default_modal_cancel?e._on_default_modal_cancel():void 0}})(this),this.download_signup_modal=new _({element_id:"shared-link-download-signup-modal"}),this.download_signup_modal.before_show=this.before_download_signup_modal,this.download_signup_modal.on_hide=(function(e){return function(){if(!e._direct_download_started)return"function"==typeof e._on_direct_download_cancel?e._on_direct_download_cancel():void 0}})(this),this.welcome_modal=new _({element_id:"shared-link-welcome-modal"}),this.welcome_modal.before_show=this.before_welcome_modal,this.create_password_modal=new _({element_id:"shared-link-create-password-modal"}),this.create_password_modal.before_show=this.before_create_password_modal},t.prototype.before_signup_modal=function(e){var t,n;if(e.find(".toggle-form-link").click((function(t){return function(){return t.toggle_form(e)}})(this)),n=e.find(".register-form"),n.length&&(n.on(m.NEW_ACCOUNT_FROM_3RD_PARTY,(function(t){return function(n,r){return t.profile_info=r,t.show_create_password_modal(e,t.profile_info)}})(this)),n.on(m.USER_EXISTS,(function(t){return function(n){return t.show_login_form(e,n)}})(this)),n.on(m.REGISTER_SUCCESS,(function(e){return function(t,n){return e.user_info=n,e.register_success(e.user_info)}})(this))),t=e.find(".login-form"),t.length)return t.on(u.LOGIN_SUCCESS,(function(e){return function(t,n){return e.user_info=n,a.success(y("Successfully signed in to Dropbox")),e.download_type?"direct_download"===e.download_type?(e.direct_download(),e.reload()):"add_to_dropbox"===e.download_type?e.save_to_dropbox(!1):void 0:e.reload()}})(this))},t.prototype.before_default_signup_modal=function(e){return this.before_signup_modal(e),e.find(".close-link").click((function(e){return function(){return e.default_signup_modal.hide()}})(this))},t.prototype.before_download_signup_modal=function(e){return this.before_signup_modal(e),this._direct_download_started=!1,"add_to_dropbox"===this.download_type&&(e.find(".login-form-component").is(":visible")||this.toggle_form(e)),e.find(".close-link").click((function(e){return function(){return e.direct_download(),e.download_signup_modal.hide()}})(this))},t.prototype.before_create_password_modal=function(e){var t,n;return e.find(".close-link").click((function(e){return function(){return e.create_password_modal.hide()}})(this)),t=e.find(".create-password-form-component"),n=t.find(".register-form"),n.on(m.REGISTER_SUCCESS,(function(e){return function(t,n){return e.user_info=n,e.register_success(e.user_info)}})(this))},t.prototype.before_welcome_modal=function(e){return p.log("sharing","shared_link_welcome_modal_view"),e.find(".go-to-dropbox-button").click(function(){return p.log("sharing","shared_link_welcome_modal_button_click")}),e.find(".welcome-modal-no-thanks a").click(function(){return i.reload()})},t.prototype.show_welcome_modal=function(){return this.default_signup_modal.hide(),this.download_signup_modal.hide(),this.welcome_modal.show()},t.prototype.show_create_password_modal=function(e,t){var n;return this.default_signup_modal.hide(),this.download_signup_modal.hide(),n={".input-fname":this.profile_info.fname,".input-lname":this.profile_info.lname,".input-email":this.profile_info.email,"input[name=email_sig]":this.profile_info.email_sig,"input[name=refresh_token]":this.profile_info.refresh_token},this.create_password_modal.show("input[name=password]",n)},t.prototype.on_request_direct_download=function(){return this.has_seen_modal?this.direct_download():(this.has_seen_modal=!0,g.log("signup_modal-show-download",{auth_google:null!=n.find(".auth-google")}),this.download_type="direct_download",this.download_signup_modal.show())},t.prototype.on_request_default_signup=function(){return this.download_type="add_to_dropbox",this._has_authenticated=!1,this.default_signup_modal.show()},t.prototype.handle_direct_download=function(e){return this._direct_download_override_callback=e},t.prototype.handle_direct_download_cancel=function(e){return this._on_direct_download_cancel=e},t.prototype.handle_default_modal_authenticate=function(e){return this._on_default_modal_authenticate=e},t.prototype.handle_default_modal_cancel=function(e){return this._on_default_modal_cancel=e},t.prototype.direct_download=function(){var e;return this._direct_download_started=!0,null!=this._direct_download_override_callback?void this._direct_download_override_callback():(e=i.get_uri().updateQuery({dl:1}),i.redirect(e))},t.prototype.reload=function(){return i.reload()},t.prototype.save_to_dropbox=function(e){var t;return null!=this._on_default_modal_authenticate?(this._on_default_modal_authenticate(this.user_info.id),this._has_authenticated=!0,void this.default_signup_modal.hide()):(e||a.success(y("Saving to your Dropbox ...")),t=f.c2d_vars,t.job=f.is_folder,r.WebRequest({url:f.c2d_url,data:t,subject_user:this.user_info.id,success:function(t){if(!e)return a.success(y("Successfully saved to your Dropbox.")),i.redirect(t)}}))},t.prototype.show_login_form=function(e,t){var n,r,o,i,s;r=e.find(".login-form-component"),o=r.find(".login-form"),i=t.prefill;for(n in i)s=i[n],o.find(n).val(s);if(o.find(t.focus).focus(),!r.is(":visible"))return this.toggle_form(e,!0)},t.prototype.toggle_form=function(e,t){var r,o;return o=e.find(".register-form-component"),r=e.find(".login-form-component"),o.is(":visible")?o.fadeOut({complete:function(){if(r.show(),null!=t)return setTimeout(function(){return n(r.find(".login-form .login-password input[name='login_password']")[0]).focus()},0)}}):r.fadeOut({complete:function(){return o.show()}})},t.prototype.register_success=function(e){return a.success(y("Successfully signed up for Dropbox.")),this.download_type?"direct_download"===this.download_type?(this.direct_download(),this.show_welcome_modal()):"add_to_dropbox"===this.download_type?this.save_to_dropbox(!1):void 0:this.show_welcome_modal()},t})()})}.call(this);
//# sourceMappingURL=pkg-maestro-aa.min.js-vflR696wy.map