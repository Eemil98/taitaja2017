(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define("modules/clean/deprecated/uirequest",["jquery","external/underscore","modules/core/html","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/css","modules/clean/legacy_pyxl_controllers/ajax_form","modules/clean/dbmodal","modules/pagelet_config"],function(e,o,n,r,i,s,a,p,c,u){var l,m,d;return d=r._,l=c.DBModal,m=u.REQUIREJS_CONFIG,(function(){function r(e,n,r){if(this.$node=e,this.url=n,this.options=null!=r?r:{},this.complete=t(this.complete,this),this.handle_errors=t(this.handle_errors,this),this.error=t(this.error,this),this.perform_actions=t(this.perform_actions,this),this.success=t(this.success,this),this.shouldDelayComplete=!1,this.$node.hasClass("ajax-loading"))return!1;this.$node.addClass("ajax-loading"),s.FormWebRequest({url:this.url,type:null!=this.options.type?this.options.type:void 0,data:this.options.data||{},success:this.success,error:this.error,complete:this.complete,subject_user:this.options.subject_user,headers:o.extend({"X-RequireJS-Context":m.context,"X-UIRequest-Version":3},this.options.headers)})}return r.prototype.success=function(t,e,o){var n,r,i;return(i=p.extract_errors(o.responseText))?(this.handle_errors(i),void("function"==typeof(n=this.options).error&&n.error(o,e))):(t=JSON.parse(o.responseText),t.redirect?void(window.location.href=t.redirect):t.reload?void window.location.reload():(this.shouldDelayComplete=t.js||t.css,this.shouldDelayComplete?a.require_css_multi(t.css,(function(n){return function(){var r,i;return n.perform_actions(t.actions||[]),"function"==typeof(r=n.options).success&&r.success(t,e,o),n.$node.removeClass("ajax-loading"),"function"==typeof(i=n.options).complete?i.complete(o,e):void 0}})(this)):(this.perform_actions(t.actions||[]),void("function"==typeof(r=this.options).success&&r.success(t,e,o)))))},r.prototype.perform_actions=function(t){var o,r,s,a,p,c,u,m,d,_,h,f;for(_=[],p=0,c=t.length;p<c;p++)switch(r=t[p],a=r[0],s=r[1],f=r[2],o=this.$node,f&&"modal"!==a&&("^"===f.charAt(0)&&(m=f.split(" "),o=o.closest(m[0].substr(1)),f=m.slice(1).join(" ")),f&&(o=o.find(f).filter(":first"))),a){case"modal":d="db-modal-response-modal-placeholder",e("#"+d).remove(),h=e(s),h.attr("id",d),e("body").append(h),u=new l({element_id:"response-modal-placeholder"}),_.push(u.show());break;case"html":_.push(o.html(s));break;case"replaceWith":_.push(o.replaceWith(s));break;case"after":s?_.push(o.after(s)):_.push(void 0);break;case"before":s?_.push(o.before(s)):_.push(void 0);break;case"toggleClass":_.push(o.toggleClass(s));break;case"addClass":_.push(o.addClass(s));break;case"removeClass":_.push(o.removeClass(s));break;case"notify":_.push(i.success(s));break;case"notifyError":_.push(i.error(new n(s),this.options.errorDuration||void 0));break;default:_.push(void 0)}return _},r.prototype.error=function(t,e,o){var n,r;return r=p.extract_errors(t.responseText),"abort"!==e&&this.handle_errors(r),"function"==typeof(n=this.options).error?n.error(t,e,o):void 0},r.prototype.handle_errors=function(t){var e;return t===!1?i.error(d("There was a problem completing this request.")):"string"==typeof t?(e=this.options.html_in_error_msg?new n(t):t,i.error(e)):p.fill_errors(this.$node,t)},r.prototype.complete=function(t,e){var o;if(!this.shouldDelayComplete)return this.$node.removeClass("ajax-loading"),"function"==typeof(o=this.options).complete?o.complete(t,e):void 0},r})()})}).call(this),define("modules/clean/admin/megaphone/prompt/api/utils",["require","exports","external/underscore"],function(t,e,o){"use strict";(function(t){var e=function(t){return t.replace(/_(.)/g,function(t,e){return e.toUpperCase()})},n=function(t){return t.replace(/([a-z\d])([A-Z0-9])/g,function(t,e,o){return e+"_"+o.toLowerCase()})},r=function(t,e){var o={};return Object.keys(e).forEach(function(n){var i,s=e[n];i="object"==typeof s&&null!==s?r(t,s):s,o[t(n)]=i}),o},i=function(t){var e={},i=r(n,t);return o.each(o.keys(i),function(t){i[t]&&i[t].id?e[t]=i[t].id:e[t]=i[t]}),e.approved=!(!e.approved_time&&!e.approved_user),delete e.approved_time,delete e.approved_user_id,e.start_time_enabled=null!==e.start_time,e.end_time_enabled=null!==e.end_time,e.remind_me_later_enabled=null!==e.remind_me_later_type,e.remind_me_later_enabled||(e.remind_me_later_type=null,e.remind_me_later_delay=null),o.each(o.keys(e),function(t){"boolean"==typeof e[t]&&(e[t]=e[t]?"on":"off")}),e.upsell_promo_spec=e.cash_promo,delete e.cash_promo,delete e.id,delete e.created_time,delete e.promo_params,delete e.updated_time,delete e.user,delete e.locale,e};t.requestDataFromCampaignAndVersion=function(t,e){var s=i(t),a=r(n,e.content);delete s.content;var p=["modal_type"];return o.each(o.keys(a),function(t){if(o.contains(p,t))s[t]=a[t];else{if(null===a[t])return;s["content["+t+"]"]=a[t]}}),s.stormcrow_variant=e.stormcrowVariant,"content[image_url]"in s&&(s["content[image]"]=s["content[image_url]"],delete s["content[image_url]"]),"content[cancel_with_xIcon]"in s&&(s["content[cancel_with_x_icon]"]=s["content[cancel_with_xIcon]"],delete s["content[cancel_with_xIcon]"]),o.each(o.keys(s),function(t){"boolean"==typeof s[t]&&(s[t]=s[t]?"on":"off")}),s},t.toCamelCase=function(t){return r(e,t)},t.jsonToCamelCase=function(e){var o=JSON.parse(e);return t.toCamelCase(o)},t.stringToCamelCase=function(t){return e(t)}})(e.APIUtils||(e.APIUtils={}))}),define("modules/clean/prompt/ha_loader",["require","exports","jquery","modules/clean/admin/megaphone/prompt/api/utils","external/react","external/react-dom","modules/clean/ajax","modules/clean/upsell/exception","modules/clean/react/prompt/ha"],function(t,e,o,n,r,i,s,a,p){"use strict";function c(t){try{if(!t.userID)return;var e=o(t.isMaestroDesign?"#prompt-silo .ha-silo":"#ha-container");s.SilentBackgroundRequest({url:"/prompt/ha",subject_user:t.userID,data:{ref_controller:t.controller,ref_action:t.action,campaign_id:t.campaignID,is_maestro:t.isMaestroDesign}}).then(function(o){var s=n.APIUtils.jsonToCamelCase(o);s.campaign&&(s.subjectUser=t.userID,i.render(r.createElement(p.HA,s),e[0]))})}catch(e){a.reportException({err:e,tags:[a.TAGS.PROMPT_HA_LOADER],exc_extra:{param_user_id:t.userID,param_controller:t.controller,param_action:t.action,param_campaign_id:t.campaignID,param_is_maestro_design:t.isMaestroDesign}})}}e.initialize_module=c}),define("modules/clean/react/prompt/button",["require","exports","tslib","external/classnames","external/purify","external/react"],function(t,e,o,n,r,i){"use strict";function s(t){return t?{__html:r.sanitize(t)}:void 0}var a=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.render=function(){var t=n(this.props.className,{"confirm-button":!0,enabled:!0});return this.props.confirmIsPost?i.createElement("form",{action:this.props.confirmUrl,method:"POST",target:this.getTarget(),onSubmit:this.props.onConfirm},i.createElement("button",{type:"submit",className:t,dangerouslySetInnerHTML:s(this.props.html)},this.props.children)):i.createElement("a",{href:this.props.confirmUrl,className:t,target:this.getTarget(),dangerouslySetInnerHTML:s(this.props.html),onClick:this.props.onConfirm},this.props.children)},e.prototype.getTarget=function(){return this.props.confirmInNewTab?"_blank":"_self"},e})(i.Component);e.ConfirmButton=a;var p=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.render=function(){var t=n(this.props.className,{"dismiss-button":!0,enabled:!0});return i.createElement("a",{href:"#",className:t,dangerouslySetInnerHTML:s(this.props.html),onClick:this.props.onDismiss},this.props.children)},e})(i.Component);e.DismissButton=p}),define("modules/clean/react/prompt/campaign_state_manager",["require","exports","jquery","modules/core/uri","modules/clean/ajax","modules/clean/upsell/upsell_controller"],function(t,e,o,n,r,i){"use strict";var s=(function(){function t(t){var e=this;this.onShow=function(){e.component.state.isShown||(e.component.setState(function(t){return t.isShown=!0,t}),e.triggerExternalEvent(i.ON_SHOW_EVENT_NAME),r.SilentBackgroundRequest({type:"POST",url:e.getUpsellControllerURI("/prompt/log_impression").toString()}))},this.onConfirm=function(t){e.isAckInProgress()||(e.component.setState(function(t){return t.isConfirmed=!0,t}),e.triggerExternalEvent(i.PRE_CONFIRM_EVENT_NAME),e.component.props.campaign.content.confirmInNewTab||"#"!==e.component.props.campaign.content.confirmUrl||t.preventDefault(),"#"===e.component.props.campaign.content.confirmUrl&&e.recordConfirm())},this.onDismiss=function(t){e.isAckInProgress()||(e.component.setState(function(t){return t.isDismissed=!0,t}),t.preventDefault(),e.triggerExternalEvent(i.PRE_DISMISS_EVENT_NAME),e.recordDismiss())},this.component=t}return t.prototype.getConfirmUrl=function(){if("#"===this.component.props.campaign.content.confirmUrl)return"#";var t=this.getUpsellControllerURI("/prompt/confirm_v2"),e=this.component.props.campaign.content.confirmIsPost;return t.updateQuery({redirect_url:this.getRedirectURL()}),e&&t.updateQuery({preserve_post:"1"}),t.toString()},t.prototype.recordConfirm=function(){var t=this.getUpsellControllerURI("/prompt/confirm");this.recordAck(t,i.ON_CONFIRM_EVENT_NAME)},t.prototype.recordDismiss=function(){var t=this.getUpsellControllerURI("/prompt/dismiss");this.recordAck(t,i.ON_DISMISS_EVENT_NAME)},t.prototype.recordAck=function(t,e){var o=this;r.SilentBackgroundRequest({type:"POST",url:t.toString()}).done(function(t){o.triggerExternalEvent(e)})},t.prototype.getUpsellControllerURI=function(t){var e={campaign_id:this.component.props.campaign.campaignId.toString(),prompt_queried_at_ms:this.component.props.promptQueriedAtMs.toString()};return e._subject_uid=String(this.component.props.subjectUser),new n({path:t,query:e})},t.prototype.getRedirectURL=function(){if(this.component.props.campaign.addTkParams){var t=n.parse(this.component.props.campaign.content.confirmUrl);return t.updateQuery({_tk:this.component.props.campaign.campaignLocationTkId,_camp:this.component.props.campaign.campaignId.toString()}),t.toString()}return this.component.props.campaign.content.confirmUrl},t.prototype.isAckInProgress=function(){return this.component.state.isConfirmed||this.component.state.isDismissed},t.prototype.triggerExternalEvent=function(t){o(document).trigger(t,{campaignName:this.component.props.campaign.campaignName})},t})();e.CampaignStateManager=s}),define("modules/clean/react/prompt/ha",["require","exports","tslib","jquery","external/classnames","external/react","external/react-dom","modules/clean/react/css","modules/clean/react/sprite","modules/clean/upsell/prompt_event_emitter","modules/clean/react/prompt/campaign_state_manager","modules/clean/react/prompt/button","modules/clean/react/prompt/image","modules/core/i18n"],function(t,e,o,n,r,i,s,a,p,c,u,l,m,d){"use strict";var _;(function(t){t[t.HIDE=1]="HIDE",t[t.NO_IMAGE=2]="NO_IMAGE",t[t.SHOW=3]="SHOW"})(_=e.ShowState||(e.ShowState={})),e.UpdateInterval=1e3;var h=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.renderImage=function(){var t=this.props.content;return t.imageUrl?i.createElement(l.ConfirmButton,{className:"confirm-button--illustration",confirmInNewTab:t.confirmInNewTab,confirmIsPost:t.confirmIsPost,confirmUrl:this.props.confirmUrl,onConfirm:this.props.onConfirm},i.createElement(m.Image,{src:t.imageUrl,srcHiRes:t.imageUrlHiRes,alt:t.confirmText,onLoad:this.props.onImageLoad})):null},e.prototype.renderText=function(){var t=this.props.content;return i.createElement("p",null,i.createElement(l.ConfirmButton,{confirmInNewTab:t.confirmInNewTab,confirmIsPost:t.confirmIsPost,confirmUrl:this.props.confirmUrl,html:t.text,onConfirm:this.props.onConfirm}))},e.prototype.renderConfirmButton=function(){var t=this.props.content;return t.confirmText?i.createElement(l.ConfirmButton,{className:"button",confirmInNewTab:t.confirmInNewTab,confirmIsPost:t.confirmIsPost,confirmUrl:this.props.confirmUrl,html:t.confirmText,onConfirm:this.props.onConfirm}):null},e.prototype.renderDismissButton=function(){return this.props.isMaestroDesign?i.createElement(l.DismissButton,{onDismiss:this.props.onDismiss,"aria-label":d._("Close")},i.createElement(p,{group:"web",name:"close_small",alt:d._("Close")})):i.createElement(l.DismissButton,{onDismiss:this.props.onDismiss,"aria-label":d._("Close")})},e.prototype.render=function(){var t=this.props.isDismissed,e=r({ha:!0,"no-image":!t&&this.props.showState===_.NO_IMAGE,visible:!t&&this.props.showState===_.SHOW,invisible:this.props.isInvisible});return i.createElement("div",{className:e},this.renderImage(),this.renderText(),this.renderConfirmButton(),this.renderDismissButton())},e})(i.Component);h.displayName="HARendererWithoutCSS",e.HARendererWithoutCSS=h;var f=a(h,["/static/css/upsell/ha-vflFib0oC.css"]),g=(function(t){function r(e){var o=t.call(this,e)||this;return o.setHaRef=function(t){o.ha=t},o.setHaCloneRef=function(t){o.haClone=t},o.state={cloneShowState:_.SHOW,isConfirmed:!1,isDismissed:!1,isShown:!1,showState:_.HIDE},o.onPageUpdate=o.onPageUpdate.bind(o),o.state_manager=new u.CampaignStateManager(o),o}return o.__extends(r,t),r.prototype.componentDidMount=function(){this.onUpdate(),n(window).resize(this.onPageUpdate),c.Emitter.addListener(c.Events.REACT_HA_DID_UPDATE,this.onPageUpdate),this.intervalID=setInterval(this.onPageUpdate,e.UpdateInterval)},r.prototype.componentWillUnmount=function(){n(window).off("resize",this.onPageUpdate),c.Emitter.off(c.Events.REACT_HA_DID_UPDATE,this.onPageUpdate),clearInterval(this.intervalID)},r.prototype.componentDidUpdate=function(){this.onUpdate()},r.prototype.onPageUpdate=function(){this.setState(function(t){return t.cloneShowState=_.SHOW,t})},r.prototype.onUpdate=function(){var t=this;if(this.state.cloneShowState>_.HIDE&&this.canFit())this.state.showState!==this.state.cloneShowState&&this.setState(function(t){return t.showState=t.cloneShowState,t},function(){t.state_manager.onShow()});else{var e=this.state.cloneShowState-1;e>_.HIDE?this.setState(function(t){return t.cloneShowState=e,t}):this.state.showState!==_.HIDE&&this.setState(function(t){return t.showState=_.HIDE,t})}},r.prototype.render=function(){return i.createElement("div",null,i.createElement(f,{isInvisible:!1,content:this.props.campaign.content,confirmUrl:this.state_manager.getConfirmUrl(),isDismissed:this.state.isDismissed,isMaestroDesign:this.props.isMaestroDesign,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,ref:this.setHaRef,showState:this.state.showState}),i.createElement(f,{isInvisible:!0,content:this.props.campaign.content,confirmUrl:this.state_manager.getConfirmUrl(),isDismissed:this.state.isDismissed,isMaestroDesign:this.props.isMaestroDesign,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,onImageLoad:this.onPageUpdate,ref:this.setHaCloneRef,showState:this.state.cloneShowState}))},r.prototype.canFit=function(){return this.props.isMaestroDesign?this.canFitMaestro():this.canFitOld()},r.prototype.canFitMaestro=function(){var t=this.getMenuHeight();if(null===t)return!1;var e=this.getHAHeight();return null!==e&&t+e<=this.getWindowHeight()},r.prototype.canFitOld=function(){var t=this.getHABottom();return null!==t&&(t+this.getFooterHeight()<=this.getWindowHeight()||!this.isHAFixed())},r.prototype.getHABottom=function(){var t=n(s.findDOMNode(this.ha)),e=n(s.findDOMNode(this.haClone));return t.length>0&&e.length>0?t.offset().top-n(document).scrollTop()+e.outerHeight():null},r.prototype.getHAHeight=function(){var t=n(s.findDOMNode(this.haClone));if(0===t.length)return null;return t.outerHeight()+75},r.prototype.getMenuHeight=function(){var t=n(".maestro-secondary-sidebar, .appactions-menu").first();if(0===t.length)return null;var e=t.children(),o=t.offset().top-n(document).scrollTop();return e.each(function(t,e){o+=n(e).outerHeight(!0)}),o},r.prototype.getFooterHeight=function(){return n("#page-footer").outerHeight()+5},r.prototype.getWindowHeight=function(){return n(window).height()},r.prototype.isHAFixed=function(){var t=n(s.findDOMNode(this.ha));return t.add(t.parents()).is(function(){return"fixed"===n(this).css("position")})},r})(i.Component);e.HA=g}),define("modules/clean/react/prompt/image",["require","exports","tslib","external/react"],function(t,e,o,n){"use strict";var r=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.render=function(){var t=this.props.srcHiRes?this.props.srcHiRes+" 2x":void 0;return n.createElement("img",{src:this.props.src,srcSet:t,alt:this.props.alt,onLoad:this.props.onLoad})},e})(n.Component);e.Image=r}),define("modules/clean/upsell/exception",["require","exports","modules/core/exception"],function(t,e,o){"use strict";function reportException(t){var n=t.err,r=t.tags,i=void 0===r?[]:r,s=t.severity,a=void 0===s?o.SEVERITY.CRITICAL:s,p=t.exc_extra,c=void 0===p?{}:p;i.push(e.TAGS.PROMPT),i.push(e.TAGS.MEGAPHONE),o.reportException({err:n,tags:i,severity:a,exc_extra:c})}function n(t){var n=t.err,r=t.js_controller_options,i=void 0===r?{}:r,s=t.severity,a=void 0===s?o.SEVERITY.CRITICAL:s,p=[],c={"campaign-name":"campaignName",location:"campaignLocationId"};for(var u in c)if(c.hasOwnProperty(u)){var l=c[u],m=i[l];m&&p.push("prompt-"+u+"-"+m)}e.reportException({err:n,tags:p,severity:a,exc_extra:i})}e.SEVERITY=o.SEVERITY,e.TAGS={MEGAPHONE:"megaphone",PROMPT:"prompt",PROMPT_ADMIN:"prompt-admin",PROMPT_HA_LOADER:"prompt-ha-loader",PROMPT_LOADER:"prompt-loader",PROMPT_MAIN_AND_ACCOUNT_HEADER_LOADER:"prompt-main-and-account-header-loader",PROMPT_MUTUALLY_EXCLUSIVE_LOADER:"prompt-mutually-exclusive-loader"},e.reportException=reportException,e.reportJsControllerException=n}),define("modules/clean/upsell/prompt_loader",["require","exports","jquery","modules/clean/deprecated/uirequest","modules/clean/prompt/ha_loader","modules/clean/upsell/exception","modules/clean/user_education/user_education_loader"],function(t,e,o,n,r,i,s){"use strict";function a(t){try{if(t.mutually_exclusive_loading?new u({user_id:t.user_id,controller:t.controller,action:t.action,in_app:t.in_app,sprite_group:t.sprite_group,is_maestro:t.is_maestro,use_uirequest:t.use_uirequest}):(new c({user_id:t.user_id,controller:t.controller,action:t.action,in_app:t.in_app,sprite_group:t.sprite_group,is_maestro:t.is_maestro,use_uirequest:t.use_uirequest}),r.initialize_module({userID:t.user_id,controller:t.controller,action:t.action,isMaestroDesign:t.is_maestro})),t.top_notification_bar){var e=o(".maestro body");e&&e.addClass("has-top-notification")}}catch(e){i.reportException({err:e,tags:[i.TAGS.PROMPT_LOADER],exc_extra:{param_config:t}})}}var p=(function(){function t(t){this.response_data=t}return t.prototype.didCampaignLoad=function(t,e){for(var o=this.response_data.actions||[],n=0,r=o;n<r.length;n++){var i=r[n],s=i[1];if(i[2]===t&&s)return!e||s.indexOf(e)>=0}return!1},t.prototype.didHeaderBubbleLoad=function(){return this.didCampaignLoad("^body #prompt-silo .account-header-silo","header-bubble-container")},t.prototype.didHeaderLinkLoad=function(){return!this.didHeaderBubbleLoad()&&this.didCampaignLoad("^body #prompt-silo .account-header-silo","header-link")},t.prototype.didMainCampaignLoad=function(){return this.didHeaderBubbleLoad()||this.didCampaignLoad("^body #prompt-silo .main-silo")},t.prototype.didAccountHeaderCampaignLoad=function(){return this.didHeaderBubbleLoad()||this.didHeaderLinkLoad()},t.prototype.didCampaignForUserEducationLoad=function(){return this.didCampaignLoad("^body #prompt-silo .main-silo",'"onboardingModuleName":')&&!this.didCampaignLoad("^body #prompt-silo .main-silo",'"onboardingModuleName": null')},t})(),c=(function(){function t(t){var e=this;try{t.options||(t.options={});new n(o(t.is_maestro?"#prompt-silo .main-silo":"#outer-frame"),"/prompt/main_campaign",{data:{ref_controller:t.controller,ref_action:t.action,in_app:t.in_app,sprite_group:t.sprite_group,skip_main_campaign:t.options.skip_main_campaign,is_maestro:t.is_maestro},dataType:"json",subject_user:t.user_id,success:function(n){o(".db-modal-overlay").is(":visible")||o("#db-modal-upsell-home-modal").addClass("show-upsell-modal").trigger("show-upsell-modal"),"function"==typeof t.options.success&&t.options.success(n),e.checkAndNotifyUserEducation(n)}})}catch(e){i.reportException({err:e,tags:[i.TAGS.PROMPT_MAIN_AND_ACCOUNT_HEADER_LOADER],exc_extra:{param_user_id:t.user_id,param_controller:t.controller,param_action:t.action,param_in_app:t.in_app,param_sprite_group:t.sprite_group,param_is_maestro:t.is_maestro,param_options_skip_main_campaign:t.options.skip_main_campaign}})}}return t.prototype.checkAndNotifyUserEducation=function(t){new p(t).didCampaignForUserEducationLoad()||s.UELoader.notifyModuleToLoad(null)},t})(),u=(function(){function t(t){try{this.didTopNotificationLoad()?t.options={skip_main_campaign:!0,success:function(e){new p(e).didAccountHeaderCampaignLoad()||r.initialize_module({userID:t.user_id,controller:t.controller,action:t.action,isMaestroDesign:t.is_maestro})}}:t.options={success:function(e){new p(e).didMainCampaignLoad()||r.initialize_module({userID:t.user_id,controller:t.controller,action:t.action,isMaestroDesign:t.is_maestro})}},new c(t)}catch(e){i.reportException({err:e,tags:[i.TAGS.PROMPT_MUTUALLY_EXCLUSIVE_LOADER],exc_extra:{param_user_id:t.user_id,param_controller:t.controller,param_action:t.action,param_in_app:t.in_app,param_sprite_group:t.sprite_group,param_is_maestro:t.is_maestro}})}}return t.prototype.didTopNotificationLoad=function(){return!!o("#top-notification-bar-container").length},t})();e.initialize_module=a}),function(){define("modules/clean/upsell/prompt_event_emitter",["external/eventemitter3"],function(t){return{Events:{REACT_HA_DID_UPDATE:"REACT_HA_DID_UPDATE"},Emitter:new t}})}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define("modules/clean/upsell/upsell_controller",["jquery","modules/clean/ajax","modules/clean/upsell/exception","modules/core/dom","modules/core/uri"],function(e,o,n,r,i){return(function(){function s(o,n,r){this.options=r,this.post_confirm=t(this.post_confirm,this),this.post_dismiss=t(this.post_dismiss,this),this.confirm=t(this.confirm,this),this.dismiss=t(this.dismiss,this),this._keydown=t(this._keydown,this),o.length>0&&o.one("click",(function(t){return function(e){return t.confirm(e)}})(this)),n.length>0&&n.one("click",(function(t){return function(o){var n;return n=e(o.target).hasClass("remind-me-later"),t.dismiss(o,n)}})(this)),this.options.dismissWithKeys&&e(document).on("keydown",this._keydown),s.add_tk_params(o,{addTkParams:this.options.addTkParams,campaignId:this.options.campaignId,campaignLocationTkId:this.options.campaignLocationTkId}),o.add(n).addClass("enabled")}return s.ON_SHOW_EVENT_NAME="db:prompt:show",s.ON_CONFIRM_EVENT_NAME="db:prompt:confirm",s.ON_DISMISS_EVENT_NAME="db:prompt:dismiss",s.PRE_CONFIRM_EVENT_NAME="db:prompt:pre-confirm",s.PRE_DISMISS_EVENT_NAME="db:prompt:pre-dismiss",s.CONFIRM="confirm",s.DISMISS="dismiss",s.LOG_IMPRESSION="log_impression",s.prototype._keydown=function(t){if(27===t.keyCode||8===t.keyCode&&!r.focus_in_input())return t.preventDefault(),e(document).off("keydown",this._keydown),this.dismiss(t)},s.prototype._campaignUrl=function(t,e){var o,n;if(o=this.options.activeUserId?t===s.CONFIRM?"/prompt/confirm":t===s.DISMISS?"/prompt/dismiss":t===s.LOG_IMPRESSION?"/prompt/log_impression":void 0:t===s.CONFIRM?"/upsell/confirm":t===s.DISMISS?"/upsell/dismiss":t===s.LOG_IMPRESSION?"/upsell/log_impression":void 0,this.options&&this.options.campaignId)return n=i({path:o}).updateQuery({campaign_id:this.options.campaignId}),t===s.DISMISS&&e&&n.updateQuery({remind_me_later:!0}),n.toString()},s.prototype._confirmOrDismiss=function(t,n,r,i){return"keydown"===t.type||r||(t.stopImmediatePropagation(),t.preventDefault()),o.SilentBackgroundRequest({type:"POST",url:n,subject_user:this.options.activeUserId,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs}}).done((function(o){return function(n){return"keydown"===t.type||r||t.target.click(),e(document).trigger(i,o.options)}})(this))},s.prototype.dismiss=function(t,o){var n;return n=this._campaignUrl(s.DISMISS,o),n&&this._confirmOrDismiss(t,n,!1,s.ON_DISMISS_EVENT_NAME),e(document).trigger(s.PRE_DISMISS_EVENT_NAME,this.options)},s.prototype.confirmUrl=function(t){var o,n;return o=e(t.currentTarget),n=o.is("button, input")&&"submit"===o.attr("type")?e(t.currentTarget).closest("form").attr("action"):o.is("a")?e(t.currentTarget).attr("href"):void 0,n||this.options.confirmUrl},s.prototype.confirmInNewTab=function(t){var o,n;return o=e(t.currentTarget),n=o.is("button, input")&&"submit"===o.attr("type")?e(t.currentTarget).closest("form").attr("target"):o.is("a")?e(t.currentTarget).attr("target"):void 0,n?"_blank"===n:this.options.confirmInNewTab},s.prototype.confirm=function(t){var o;return o=this._campaignUrl(s.CONFIRM),o&&this._confirmOrDismiss(t,o,this.confirmInNewTab(t),s.ON_CONFIRM_EVENT_NAME),e(document).trigger(s.PRE_CONFIRM_EVENT_NAME,this.options)},s.prototype.log_impression=function(){var t;if(t=this._campaignUrl(s.LOG_IMPRESSION))return o.SilentBackgroundRequest({type:"POST",url:t,subject_user:this.options.activeUserId,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs}})},s.prototype.log_event=function(t){var e,n;if(this.options&&this.options.campaignId)return e=this.options.activeUserId?"/prompt/log_event":"/upsell/log_event",n=i({path:e}).updateQuery({event_name:t,campaign_id:this.options.campaignId}),o.SilentBackgroundRequest({type:"POST",url:n.toString(),subject_user:this.options.activeUserId,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs}})},s.prototype.post_dismiss=function(){var t;if(t=this._dismissUrl())return o.SilentBackgroundRequest({type:"POST",url:t,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs}})},s.prototype.post_confirm=function(){var t;if(t=this._confirmUrl())return o.SilentBackgroundRequest({type:"POST",url:t,data:{prompt_queried_at_ms:this.options.promptQueriedAtMs}})},s.add_tk_params=function(t,o){var r;if(o.addTkParams)return o.campaignId&&o.campaignLocationTkId?t.each(function(t,n){var r,s,a,p;if(r=e(n),r.is("a")?a="href":(r=r.closest("form"),a="action"),p=r.attr(a),r.length>0&&p)return s=i.parse(p),s.updateQuery({_tk:o.campaignLocationTkId,_camp:o.campaignId}),r.attr(a,s.toString())}):(r=new Error("Missing campaignId or campaignLocationTkId."),void n.reportJsControllerException({err:r,js_controller_options:o,severity:n.SEVERITY.NONCRITICAL}))},s.register_custom_controller=function(t){var o,n,r,i,a;if(r=t.on_show,o=t.on_confirm,n=t.on_dismiss,i=t.pre_confirm,a=t.pre_dismiss,r&&e(document).on(s.ON_SHOW_EVENT_NAME,r),o&&e(document).on(s.ON_CONFIRM_EVENT_NAME,o),n&&e(document).on(s.ON_DISMISS_EVENT_NAME,n),i&&e(document).on(s.PRE_CONFIRM_EVENT_NAME,i),a)return e(document).on(s.PRE_DISMISS_EVENT_NAME,a)},s.unregister_custom_controller=function(t){var o,n,r,i,a;if(r=t.on_show,o=t.on_confirm,n=t.on_dismiss,i=t.pre_confirm,a=t.pre_dismiss,r&&e(document).off(s.ON_SHOW_EVENT_NAME,r),o&&e(document).off(s.ON_CONFIRM_EVENT_NAME,o),n&&e(document).off(s.ON_DISMISS_EVENT_NAME,n),i&&e(document).off(s.PRE_CONFIRM_EVENT_NAME,i),a)return e(document).off(s.PRE_DISMISS_EVENT_NAME,a)},s})()})}.call(this),define("modules/clean/user_education/user_education_loader",["require","exports"],function(t,e){"use strict";var o=(function(){function t(){this.loadMessage=null,this.callback=null}return t.prototype.notifyModuleToLoad=function(t){this.callback?(this.callback(t),this.callback=null):this.loadMessage={moduleName:t}},t.prototype.setLoadingCallback=function(t){this.loadMessage?t(this.loadMessage.moduleName):this.callback=t},t})();e.UELoader=new o});
//# sourceMappingURL=pkg-maestro-prompt.min.js-vflyd4YEP.map